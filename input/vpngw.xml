<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="..\transformspp2html.xsl"?>
<?xml-model href="https://raw.githubusercontent.com/commoncriteria/transforms/master/schemas/CCProtectionProfile.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>
<Module>
  <PPReference>
    <ReferenceTable/>
  </PPReference>
  <RevisionHistory/>
  <include-pkg id="X509">
    <git>
      <url>https://github.com/commoncriteria/X509</url>
      <branch>release-1.0</branch>
    </git>
    <url>https://www.niap-ccevs.org/protectionprofiles/511</url>
  </include-pkg>
  <pp-preferences/>
  <sec:Introduction>
    <sec:Overview title="Overview">
      The scope of this Protection Profile Module (PP-Module) is to describe the security functionality of a virtual private network (VPN)
      gateway in terms of
      <xref g="CC"/>
      and to define functional and assurance requirements for such
      products. This PP-Module is intended for use with the following Base-PP:
      <ul>
        <li>Network Device collaborative Protection Profile Version 4.0</li>
      </ul>
      <p>This Base-PP is valid because a VPN gateway is a device at the edge of a private network that terminates
      an IPsec tunnel, which provides device authentication, confidentiality, and integrity of information
      traversing a public or untrusted network. This is functionality that typically will be implemented by a
      network device.</p>
      <p>A Target of Evaluation (TOE) that conforms to a PP-Configuration containing this PP-Module may be a ‘Distributed TOE’ as
      defined in the NDcPP; however, the VPN gateway functionality described in this PP-Module should be in
      a single TOE component. This PP-Module does not prohibit the TOE from implementing other security
      functionality in a distributed manner. For example, a TOE may have a centralized device that performs
      VPN gateway and other security functionality (such as intrusion prevention) with a number of distributed
      nodes that help in the enforcement of the secondary functionality.</p>
    </sec:Overview>
    <tech-terms>
      <suppress>Extended Package</suppress>
      <term full="Headend">A VPN use case where the VPN gateway is establishing VPN connectivity with
        endpoint VPN clients as opposed to other infrastructure devices (e.g., site-to-site).</term>
      <term full="Packet Filtering">The process by which an edge network device determines if traffic bound to or from
        its external network is passed to its destination or dropped.</term>
      <term full="VPN Gateway">A type of network device that resides at the edge of a private network and permits
        the establishment of VPN connectivity from computers residing in an external
        network.</term>
      <term full="Virtual Private Network" abbr="VPN">A mechanism for overlaying a cryptographically secured network over distributed
        wide-area networks.</term>
      <term full="Certificate Authority" abbr="CA"/>
      <term full="Common Name" abbr="CN"/>
      <term full="Diffie-Hellman" abbr="DH"/>
      <term full="Distinguished Name" abbr="DN"/>
      <term full="Fully Qualified Domain Name" abbr="FQDN"/>
      <term full="Internet Control Message Protocol" abbr="ICMP"/>
      <term full="Internet Key Exchange" abbr="IKE"/>
      <term full="Master Session Key" abbr="MSK"/>
      <term full="Password-Based Key Derivation Function" abbr="PBKDF"/>
      <term full="Security Association" abbr="SA"/>
      <term full="Subject Alternative Name" abbr="SAN"/>
      <term full="Small Form-Factor Pluggable" abbr="SFP"/>
    </tech-terms>
    <sec:Compliant_Targets_of_Evaluation>
      <p>This PP-Module specifically addresses network gateway devices that terminate IPsec VPN tunnels. A
      compliant VPN gateway is a device composed of hardware and software that is connected to two or more
      distinct networks and has an infrastructure role in the overall enterprise network. In particular, a VPN
      gateway establishes a secure tunnel that provides an authenticated and encrypted path to one or more other sites
      and thereby decreases the risk of exposure of information transiting an untrusted network.</p>
      <p>The baseline requirements of this PP-Module are those determined necessary for a multi-site VPN
      gateway device. A compliant TOE may also contain the ability to act as a headend for remote clients.
      Because this capability is optional, the remote client-based requirements have been included in
      Appendix A.</p>
      <sec:TOE_Boundary>The physical boundary for a TOE that conforms to this PP-Module is a hardware appliance that also
        provides generalized network device functionality, such as auditing, identification and authentication, and cryptographic services for
        network communications. The TOE’s logical boundary includes all functionality required by the claimed
        Base-PP as well as the VPN functionality and related capabilities that are defined in this PP-Module. Any
        functionality that is provided by the network device that is not relevant to the security requirements
        defined by this PP-Module or the Base-PP is considered to be outside the scope of the TOE.</sec:TOE_Boundary>
    </sec:Compliant_Targets_of_Evaluation>
    <sec:Use_Cases>
      This PP-Module defines two potential use cases for the VPN gateway TOE, defined below. The first use
      case will always be applicable for a TOE that conforms to this PP-Module. The second use case defines an
      optional deployment for the TOE that accompanies the first use case.
      <usecases>
        <usecase title="Network Device" id="usecase1">
          <description>The VPN gateway is part of the functionality that is provided by a general network device appliance, such
            as a router or switch, or a device that is dedicated solely to providing multi-site VPN gateway
            functionality.</description>
        </usecase>
        <usecase title="Remote Client Headend" id="usecase2">
          <description>The VPN gateway provides the ability to act as a headend for remote clients.</description>
        </usecase>
      </usecases>
    </sec:Use_Cases>
    <section title="Package Usage">
      <package-usage-list>
        <package-usage ref="X509">
          <usage id="usage-x509-roles" title="Certificate Verification and Validation Required in FIA_XCU_EXT.1.1">
            <description>The ST author shall select the options to verify and assert identities in FIA_XCU_EXT.1.1.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-revocation-sigalgs" title="Limitations on Signature Algorithms in FIA_X509_EXT.1.1">
            <description>The TOE must utilize appropriate cryptographic algorithms that conform to CNSA standards. Thus, the TOE shall utilize no other algorithms outside of those specified in RFC 8603 for certificate or CRL signatures. 
              Additionally, the TOE shall not use ECDSA with SHA-512 signatures for OCSP responses, and shall utilize no other algorithms for OCSP responses.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-extensions" title="Required Extension Processing in FIA_X509_EXT.1.2">
            <description>The ST author shall select the option to process the basicConstraints and extendedKeyUsage extensions in FIA_X509_EXT.1.2. If the TOE supports identifiers of types other than an identifier located in the CN (i.e., any identifiers specifically labeled as "CN", or the Distinguished Name), the ST author shall select the 
              option to process the subjectAlternateName extension and the relevant options within the subjectAlternateName extension that correspond to the supported identifier types.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-revocation-methods" title="CRL or OCSP-based Revocation Required for FIA_X509_EXT.1.3 ">
            <description>The TOE must support revocation that only involves CRL or OCSP. Accordingly, the ST author shall select only from options involving CRL or OCSP in FIA_X509_EXT.1.3 (e.g., the selection to treat all certificates 
              older than a given short timeframe is not an acceptable substitute or alternative for supporting CRL or OCSP).</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-revocation-connections" title="Connections to CRL or OCSP Servers Required for FIA_X509_EXT.1.4">
            <description>Because the TOE is required to support CRL or OCSP, the TSF shall support an appropriate mechanism for obtaining revocation status information. In the case of CRL, the ST author shall claim that revocation 
              status information is obtained via network connection to a CRL distribution point. In the case of OCSP, the ST author shall claim that revocation status information is obtained via network connection to an 
              OCSP responder, via OCSP stapling, or via OCSP multi-stapling.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
          <usage id="usage-x509-usage" title="Required Function Claims in FIA_X509_EXT.2.1">
            <description>The ST author shall ensure that the selections and assignments within FIA_X509_EXT.2.1 reflect the usage of X.509 for IPsec or IKE. Other selections and assignments may be made as appropriate for other TOE functionality.</description>
            <config>
              <ref-id>dummy-ref-id</ref-id>
            </config>
          </usage>
        </package-usage>
      </package-usage-list>
    </section>
  </sec:Introduction>
  <sec:Conformance_Claims title="Conformance Claims" id="ConformanceClaims">
    <CClaimsInfo cc-version="cc-2022r1" cc-approach="direct-rationale">
      <cc-st-conf>exact</cc-st-conf>
      <cc-pt2-conf>extended</cc-pt2-conf>
      <cc-pt3-conf>conformant</cc-pt3-conf>
      <cc-pp-conf/>
      <cc-pp-config-with>
        <Mod-cc-ref>collaborative Protection Profile Module for Stateful Traffic Filter Firewalls
          v2.0</Mod-cc-ref>
        <Mod-cc-ref>PP-Module for Intrusion Protection Systems, v2.0</Mod-cc-ref>
      </cc-pp-config-with>
      <cc-pkg-claim>
        <FP-cc-ref conf="conformant">Functional Package for X.509, version 1.0</FP-cc-ref>
      </cc-pkg-claim>
    </CClaimsInfo>
  </sec:Conformance_Claims>
  <!-- 3.0 Security Problem Definition-->
  <sec:Security_Problem_Definition>
    The security problem is described in terms of the threats that the TOE is expected to address,
assumptions about its operational environment (OE), and any organizational security policies that the TOE is
expected to enforce.
    <br/>
    <!-- 3.1 Threats -->
    <sec:Threats>
      The following threats defined in this PP-Module extend the threats defined by the Base-PP.
      <threats>
        <threat name="T.DATA_INTEGRITY">
          <description>Devices on a protected network may be exposed to threats presented by devices located outside the            protected network that may attempt to modify the data without authorization or determine the contents of secure communication. If known malicious            external devices are able to communicate with devices on the protected network or if devices on the            protected network can communicate with those external devices then the data contained in the            communications may be susceptible to a loss of integrity or confidentiality. </description>
          <!-- New mapping to build updated threat mapping table. -->
          <addressed-by>FPF_RUL_EXT.1</addressed-by>
          <rationale>Mitigates the threat by filtering traffic from outside the protected network.</rationale>
          <addressed-by>FPT_FLS.1/SelfTest</addressed-by>
          <rationale>Mitigates the threat by ceasing operations of the TSF if a test or security failure is detected, preventing a failure in secure functionality.</rationale>
          <addressed-by>FPT_TST_EXT.3</addressed-by>
          <rationale>Mitigates the threat by executing self tests in a specified, repeatable manner.</rationale>
          <addressed-by>FTA_SSL.3/VPN (implementation-dependent)</addressed-by>
          <rationale>Mitigates the threat by terminating inactive VPN sessions.</rationale>
          <addressed-by>FTA_VCM_EXT.1 (implementation-dependent)</addressed-by>
          <rationale>Mitigates the threat by assigning a private, internal IP address to VPN clients within the protection of the TSF.</rationale>
          <addressed-by>FTP_ITC.1/VPN</addressed-by>
          <rationale>Mitigates the threat by transmitting data over a secure VPN connection protected from unauthorized disclosure.</rationale>
        </threat>
        <threat name="T.NETWORK_ACCESS">
          <description>             Devices located outside the protected network may seek to exercise services located on the protected            network that are intended to only be accessed from inside the protected network or only accessed by            entities using an authenticated path into the protected network. Devices located outside the            protected network may, likewise, offer services that are inappropriate for access from within the            protected network.            <br/>            From an ingress perspective, VPN gateways can be configured so that only those network servers            intended for external consumption by entities operating on a trusted network (e.g., machines            operating on a network where the peer VPN gateways are supporting the connection) are accessible            and only via the intended ports. This serves to mitigate the potential for network entities outside a            protected network to access network servers or services intended only for consumption or access            inside a protected network.            <br/>            From an egress perspective, VPN gateways can be configured so that only specific external services            (e.g., based on destination port) can be accessed from within a protected network, or moreover are            accessed via an encrypted channel. For example, access to external mail services can be blocked to            enforce corporate policies against accessing uncontrolled email servers, or, that access to the mail            server must be done over an encrypted link.          </description>
          <!-- New mapping to build updated threat mapping table. -->
          <addressed-by>FCS_CKM.1/IKE</addressed-by>
          <rationale>Mitigates the threat by generating secure keys utilized for IKE peer authentication.</rationale>
          <addressed-by>FCS_EAP_EXT.1 (selection-based)</addressed-by>
          <rationale>Mitigates the threat by securely authenticating VPN clients with a remote authentication server.</rationale>
          <addressed-by>FIA_HOTP_EXT.1 (selection-based)</addressed-by>
          <rationale>Mitigates the threat by providing a second factor of authentication via hash-based one-time passwords.</rationale>
          <addressed-by>FIA_PSK_EXT.1 (selection-based)</addressed-by>
          <rationale>Mitigates the threat by providing a second factor of authentication via a pre-shared key.</rationale>
          <addressed-by>FIA_PSK_EXT.2 (selection-based)</addressed-by>
          <rationale>Mitigates the threat by securely and randomly generating a pre-shared key.</rationale>
          <addressed-by>FIA_PSK_EXT.3 (selection-based)</addressed-by>
          <rationale>Mitigates the threat by securely deriving a pre-shared key from a password.</rationale>
          <addressed-by>FIA_TOTP_EXT.1 (selection-based)</addressed-by>
          <rationale>Mitigates the threat by providing a second factor of authentication via time-based one-time passwords.</rationale>
          <addressed-by>FPF_MFA_EXT.1 (optional)</addressed-by>
          <rationale>Mitigates the threat by providing for multi-factor authentication of VPN clients.</rationale>
          <addressed-by>FPF_RUL_EXT.1</addressed-by>
          <rationale>Mitigates the threat by filtering traffic to disallow unauthorized access.</rationale>
          <addressed-by>FTA_SSL.3/VPN (implementation-dependent)</addressed-by>
          <rationale>Mitigates the threat by terminating inactive VPN sessions to prevent potential unauthorized use.</rationale>
          <addressed-by>FTA_TSE.1 (implementation-dependent)</addressed-by>
          <rationale>Mitigates the threat by preventing connection of VPN clients that meet undesirable criteria.</rationale>
          <addressed-by>FTA_VCM_EXT.1 (implementation-dependent)</addressed-by>
          <rationale>Mitigates the threat by assigning a private, internal IP address to VPN clients within the protection of the TSF.</rationale>
        </threat>
        <threat name="T.NETWORK_DISCLOSURE">
          <description>            Devices on a protected network may be exposed to threats presented by devices located outside the            protected network, which may attempt to conduct unauthorized activities. If known malicious            external devices are able to communicate with devices on the protected network, or if devices on the            protected network can establish communications with those external devices (e.g., as a result of a            phishing episode or by inadvertent responses to email messages), then those internal devices may be            susceptible to the unauthorized disclosure of information.            <br/>            From an infiltration perspective, VPN gateways serve not only to limit access to only specific            destination network addresses and ports within a protected network, but whether network traffic will            be encrypted or transmitted in plaintext. With these limits, general network port scanning can be            prevented from reaching protected networks or machines, and access to information on a protected            network can be limited to that obtainable from specifically configured ports on identified network            nodes (e.g., web pages from a designated corporate web server). Additionally, access can be limited            to only specific source addresses and ports so that specific networks or network nodes can be blocked            from accessing a protected network thereby further limiting the potential disclosure of information.            <br/>            From an exfiltration perspective, VPN gateways serve to limit how network nodes operating on a            protected network can connect to and communicate with other networks limiting how and where            they can disseminate information. Specific external networks can be blocked altogether or egress            could be limited to specific addresses or ports. Alternately, egress options available to network            nodes on a protected network can be carefully managed in order to, for example, ensure that            outgoing connections are encrypted to further mitigate inappropriate disclosure of data through            packet sniffing.          </description>
          <!-- New mapping to build updated threat mapping table. -->
          <addressed-by>FPF_RUL_EXT.1</addressed-by>
          <rationale>Mitigates the threat by filtering traffic to disallow unauthorized traffic flows.</rationale>
          <addressed-by>FPT_FLS.1/SelfTest</addressed-by>
          <rationale>Mitigates the threat by ceasing operations of the TSF if a test or security failure is detected, preventing a failure in traffic filtering.</rationale>
          <addressed-by>FPT_TST_EXT.3</addressed-by>
          <rationale>Mitigates the threat by executing self tests in a specified, repeatable manner.</rationale>
          <addressed-by>FTA_VCM_EXT.1 (implementation-dependent)</addressed-by>
          <rationale>Mitigates the threat by assigning a private, internal IP address to VPN clients within the protection of the TSF.</rationale>
        </threat>
        <threat name="T.NETWORK_MISUSE">
          <description>            Devices located outside the protected network, while permitted to access particular public services            offered inside the protected network, may attempt to conduct inappropriate activities while            communicating with those allowed public services. Certain services offered from within a protected            network may also represent a risk when accessed from outside the protected network.            <br/>            From an ingress perspective, it is generally assumed that entities operating on external networks are            not bound by the use policies for a given protected network. Nonetheless, VPN gateways can log            policy violations that might indicate violation of publicized usage statements for publicly available            services.            <br/>            From an egress perspective, VPN gateways can be configured to help enforce and monitor protected            network use policies. As explained in the other threats, a VPN gateway can serve to limit dissemination            of data, access to external servers, and even disruption of services – all of these could be related to            the use policies of a protected network and as such are subject in some regards to enforcement.            Additionally, VPN gateways can be configured to log network usages that cross between protected            and external networks and as a result can serve to identify potential usage policy violations.                      </description>
          <!-- New mapping to build updated threat mapping table. -->
          <addressed-by>FAU_GEN.1/VPN</addressed-by>
          <rationale>Mitigates the threat by logging potential violations of policy.</rationale>
          <addressed-by>FMT_SMF.1/VPN</addressed-by>
          <rationale>Mitigates the threat by implementing a management interface that allows for authorized usage of the TOE so that unprivileged users
              do not have the ability to misuse its functions.</rationale>
          <addressed-by>FPF_RUL_EXT.1</addressed-by>
          <rationale>Mitigates the threat by filtering traffic to or from disallowed services.</rationale>
          <addressed-by>FPT_FLS.1/SelfTest</addressed-by>
          <rationale>Mitigates the threat by ceasing operations of the TSF if a test or security failure is detected, preventing a failure in
          detection or prevention of network misuse.</rationale>
          <addressed-by>FPT_TST_EXT.3</addressed-by>
          <rationale>Mitigates the threat by executing self tests in a specified, repeatable manner.</rationale>
          <addressed-by>FTA_VCM_EXT.1 (implementation-dependent)</addressed-by>
          <rationale>Mitigates the threat by assigning a private, internal IP address to VPN clients within the protection of the TSF.</rationale>
        </threat>
        <threat name="T.REPLAY_ATTACK">
          <description>            If an unauthorized individual successfully gains access to the system, the adversary may have the            opportunity to conduct a “replay” attack. This method of attack allows the individual to capture            packets traversing throughout the network and send the packets at a later time, possibly unknown by            the intended receiver. Traffic is subject to replay if it meets the following conditions:             <ul><li>Cleartext: an attacker with the ability to view unencrypted traffic can identify an appropriate              segment of the communications to replay as well in order to cause the desired outcome</li> <li>No integrity: alongside cleartext traffic, an attacker can make arbitrary modifications to captured            traffic and replay it to cause the desired outcome if the recipient has no means to detect these</li></ul></description>
          <!-- New mapping to build updated threat mapping table. -->
          <addressed-by>FPT_FLS.1/SelfTest</addressed-by>
          <rationale>Mitigates the threat by ceasing operations of the TSF if a test or security failure is detected, preventing a failure in
              detection of replay attacks.</rationale>
          <addressed-by>FPT_TST_EXT.3</addressed-by>
          <rationale>Mitigates the threat by executing self tests in a specified, repeatable manner.</rationale>
          <addressed-by>FTA_TSE.1 (implementation-dependent)</addressed-by>
          <rationale>Mitigates the threat by preventing connection from a VPN client that meets undesirable criteria.</rationale>
          <addressed-by>FTP_ITC.1/VPN</addressed-by>
          <rationale>Mitigates the threat by ensuring the channel data (in this case, VPN data) is protected from unauthorized disclosure.</rationale>
        </threat>
      </threats>
    </sec:Threats>
    <!-- 3.2 Assumptions -->
    <sec:Assumptions>
      This PP-Module defines assumptions that extend those defined in the supported Base-PP.
      <br/>
      All assumptions for the OE of the Base-PP also apply to this PP-Module.
      A.NO_THRU_TRAFFIC_PROTECTION is still operative, but only for the interfaces in the TOE that are
      defined by the Base-PP and not the PP-Module.
      <assumptions>
        <assumption name="A.CONNECTIONS">
          <description>It is assumed that the TOE is connected to distinct networks in a manner
            that ensures that the TOE's security policies will be enforced on all applicable network
            traffic flowing among the attached networks.</description>
          <consistency-rationale>The Base-PP does not define where in a particular network architecture a network device must be deployed since it is designed to be generic to various types of network devices. This PP-Module
            defines the expected architectural deployment specifically for WLAN AS network devices.</consistency-rationale>
          <objective-refer ref="OE.CONNECTIONS">
            <rationale>The OE objective OE.CONNECTIONS is realized through
              A.CONNECTIONS.</rationale>
          </objective-refer>
        </assumption>
      </assumptions>
    </sec:Assumptions>
    <!-- 3.3 Organizational Security Policies -->
    <sec:Organizational_Security_Policies>
      <OSPs/>
    </sec:Organizational_Security_Policies>
  </sec:Security_Problem_Definition>
  <!-- 4.0 Security Objectives -->
  <sec:Security_Objectives>
    <!-- 4.1 Security Objectives for the TOE -->
    <!-- 4.2 Security Objctives for the Operational Environment -->
    <sec:Security_Objectives_for_the_Operational_Environment>
      All objectives for the OE of the Base-PP also apply to this PP-Module. OE.NO_THRU_TRAFFIC_PROTECTION is still operative, but only for the interfaces in the TOE that are defined by the Base-PP and not the PP-Module.
      <SOEs>
        <SOE name="OE.CONNECTIONS">
          <description>The TOE is connected to distinct networks in a manner that ensures that the TOE security policies will
            be enforced on all applicable network traffic flowing among the attached networks.</description>
        </SOE>
      </SOEs>
    </sec:Security_Objectives_for_the_Operational_Environment>
    <!-- 4.3 Security Objectives Rationale -->
    <sec:Security_Objectives_Rationale/>
  </sec:Security_Objectives>
  <!-- 5.0 Security Requirements -->
  <sec:Security_Requirements title="Security Requirements">
    <!-- 5.1 ND PP Security Functional Requirements Direction -->
    <base-pp id="ND" name="Network Device" product="Network Device" short="ND" version="4.0">
      <git>
        <url/>
        <branch/>
      </git>
      <url>https://www.niap-ccevs.org/protectionprofiles/482</url>
      <sec-func-req-dir>In a PP-Configuration that includes the NDcPP, the VPN gateway is expected to rely on some of the
			security functions implemented by the network device as a whole and evaluated against the Base-PP.
			In this case, the following sections describe any modifications that the ST author must make to the SFRs
			defined in the Base-PP in addition to what is mandated by section 5.2.</sec-func-req-dir>
      <!-- 5.1.1 Modified SFRs -->
      <modified-sfrs/>
      <!-- 5.1.2 Additional SFRs -->
      <additional-sfrs/>
      <con-toe>When this PP-Module is used to extend the NDcPP, the TOE type for the overall TOE is still a network
        device. The TOE boundary is simply extended to include VPN gateway functionality that is provided by the
        network device.</con-toe>
      <con-sec-prob>The threats, assumptions, and organizational security policies (OSPs) defined by this PP-Module (see sections 3.1 through 3.3) supplement those
		defined in the NDcPP as follows:</con-sec-prob>
      <con-obj/>
      <con-op-en/>
      <con-mod ref="T.DATA_INTEGRITY">The threat of data integrity compromise is a specific example of the
        T.WEAK_CRYPTOGRAPHY threat defined in the Base-PP.</con-mod>
      <con-mod ref="T.NETWORK_ACCESS">The threat of a malicious entity accessing protected network resources
        without authorization is a specific example of the
        T.UNTRUSTED_COMMUNICATION_CHANNELS threat defined in the Base-PP.</con-mod>
      <con-mod ref="T.NETWORK_DISCLOSURE">Exposure of network devices due to insufficient protection is a specific
        example of the T.UNTRUSTED_COMMUNICATION_CHANNELS threat defined
        in the Base-PP.</con-mod>
      <con-mod ref="T.NETWORK_MISUSE">Depending on the specific nature of the misuse of network resources, this
        threat is a specific manifestation of either the
        T.UNTRUSTED_COMMUNICATION_CHANNELS or
        T.WEAK_AUTHENTICATION_ENDPOINTS threat defined in the Base-PP.</con-mod>
      <con-mod ref="T.REPLAY_ATTACK">A replay attack is mentioned in the Base-PP as a specific type of attack based
        on the T.UNTRUSTED_COMMUNICATION_CHANNELS threat.</con-mod>
      <con-mod ref="A.CONNECTIONS">This assumption defines the TOE’s placement in a network such that it is able to perform its required security functionality. The Base-PP does not define any assumptions about the TOE’s architectural deployment so there is no conflict here.</con-mod>
      <con-mod ref="OE.CONNECTIONS">This objective intends for the TOE to be connected to environmental networks in such a way that its primary functionality can be appropriately enforced. There is no
        inconsistency here with respect to the Base-PP because the Base-PP does not define any restrictions on how a network device is connected to its environment.</con-mod>
    </base-pp>
    <!-- 5.2 TOE Security Functional Requirements -->
    <man-sfrs>
      <section id="ss-audit-table" title="Auditable Events for Mandatory SFRs">
        <audit-table id="mandatory-audit-events" table="mandatory"/>
      </section>
      <!-- 5.2.1 Security Audit (FAU) -->
      <section title="Security Audit (FAU)" id="fau-mandatory">
        <!-- FAU_GEN.1/VPN Audit Data Generation (VPN Gateway) -->
        <f-component cc-id="fau_gen.1" id="fau-gen-1-vpn" name="Audit Data Generation (VPN Gateway)" iteration="VPN">
          <consistency-rationale>This SFR adds new auditable events for the TOE that relate to the functionality that is introduced by the PP-Module.</consistency-rationale>
          <f-element id="fau-gen-1e1-vpn">
            <title>
              The TSF shall be able to generate audit data of the following
              auditable events:
              <ol type="a">
                <li>Start-up and shutdown of the audit functions</li>
                <li>All auditable events for the [<i>not specified</i>] level of audit;</li>
                <li>[<i>Indication that TSF self-test was completed</i></li>
                <li>
                  <i>Failure of self-test</i>
                </li>
                <li><i>auditable events defined in the Auditable Events for Mandatory Requirements table</i>].</li>
              </ol>
            </title>
            <note role="application">The "Start-up and shutdown of the audit functions" event is identical to the event defined in the Base-PP's iteration of FAU_GEN.1.
              The TOE is not required to have two separate events for this behavior if there is only a single audit stream that which all audit events use.
              If the TOE does maintain a separate logging facility for VPN gateway-related behavior, then this event must be addressed for it. Note that if 
              the audit functions cannot be started and stopped separately from the TOE itself, then auditing the start-up and shutdown of the TOE is sufficient to address this.</note>
          </f-element>
          <f-element id="fau-gen-1e2-vpn">
            <title>
              The TSF shall record within the audit data at least the following
              information:
              <ol type="a">
                <li>Date and time of the event, type of event, subject identity (if
                  applicable), and the outcome (success or failure) of the event;</li>
                <li>
                  For each audit event type, based on the auditable event
                  definitions of the functional components included in the PP, PP-Module, functional package or ST,
                [<i>additional information defined in the Auditable Events for Mandatory Requirements table for each auditable event, where applicable</i>].
                </li>
              </ol>
            </title>
            <note role="application">The ST author only needs to include the auditable events that correspond to the SFRs claimed in the ST.
            The TOE is not required to generate auditable events for selection-based or optional SFRs that it does not claim.</note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to verify that it describes the audit mechanisms that the TOE uses to generate audit records for VPN gateway behavior. If any audit mechanisms the TSF uses for this
                are not used to generate audit records for events defined by FAU_GEN.1 in the Base-PP, the evaluator shall ensure that any VPN gateway-specific audit mechanisms also meet the relevant functional claims from the Base-PP.
                <br/>
                For example, FAU_STG_EXT.1 requires all audit records to be transmitted to the OE over a trusted channel. This includes the audit records that are required by FAU_GEN.1/VPN. Therefore, if the TOE has an audit mechanism
                that is only used for VPN gateway functionality, the evaluator shall ensure that the VPN gateway related audit records meet this requirement, even if the mechanism used to generate these audit records does not apply to any of the auditable
                events defined in the Base-PP.
                <br/>
              </TSS>
              <Guidance>
                The evaluator shall examine the operational guidance to verify that it identifies all security-relevant auditable events claimed in the ST and includes sample records of each event type. If the TOE uses multiple
                audit mechanisms to generate different sets of records, the evaluator shall verify that the operational guidance identifies the audit records that are associated with each of the mechanisms such that the source of each audit record type
                is clear.
                <br/>
              </Guidance>
              <Tests>The evaluator shall test the audit functionality by performing actions that trigger each of the claimed audit events and verifying that the audit records are accurate and that their format is consistent with what is specified in the operational guidance. The evaluator may generate these audit events as a consequence of performing other tests that would cause these events to be generated.</Tests>
            </aactivity>
          </f-element>
          <audit-event table="mandatory"/>
        </f-component>
      </section>
      <!-- 5.2.2 Cryptographic Support (FCS) -->
      <section title="Cryptographic Support (FCS)" id="fcs-mandatory">
        <!-- FCS_CKM.1/IKE Cryptographic Key Generation (for IKE Peer Authentication) -->
        <f-component cc-id="fcs_ckm.1" id="fcs-ckm-1-ike" name="Cryptographic Key Generation (for IKE Peer Authentication)" iteration="IKE">
          <consistency-rationale>This PP-Module specifies a method of key generation that is not defined in
            the Base-PP. This is used for functionality defined in the Base-PP (IKE) that
            this PP-Module chooses to represent in greater detail.</consistency-rationale>
          <f-element id="fcs-ckm-1e1-ike">
            <title>
              The TSF shall generate
              <b>asymmetric</b>
              cryptographic keys
              <b>used for IKE peer
              authentication</b>
              in accordance with a specified cryptographic key generation
              algorithm:
              <i> <selectables><selectable id="fcs_ckm.1.1_IKE_1">FIPS PUB 186-5, “Digital Signature Standard (DSS),” Appendix B.3 for RSA schemes</selectable><selectable id="fcs_ckm.1.1_IKE_2">FIPS PUB 186-5, “Digital Signature Standard (DSS),” Appendix B.4 for ECDSA schemes, and implementing “NIST curves” P-384</selectable></selectables>  and  <selectables><selectable id="fcs_ckm.1.1_IKE_3">FFC Schemes using “safe-prime” groups that meet the following: NIST Special Publication 800-56A Revision 3, “Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography” and <selectables><selectable id="fcs_ckm.1.1_IKE_4">RFC 3526</selectable><selectable id="fcs_ckm.1.1_IKE_5">RFC 7919</selectable></selectables> </selectable><selectable id="fcs_ckm.1.1_IKE_6" exclusive="yes">no other key generation algorithm</selectable></selectables></i>
              and specified cryptographic key sizes
              <assignable>key size equivalent to, or greater than, a symmetric key strength of 256 bits</assignable>
              that meet the following: [<i>no standard</i>].
            </title>
            <note role="application">
              The keys that are required to be generated by the TOE through this requirement
              are intended to be used for the authentication of the VPN peers during the IKEv2
               key exchange. FCS_CKM.1 in the Base-PP is intended to be used
              for mechanisms required by the SFRs in the Base-PP. While it is required that the
              public key be associated with an identity in an X509v3 certificate, this association
              is not required to be performed by the TOE, and instead is expected to be
              performed by a CA in the OE.
              <br/>
              <br/>
              As indicated in FCS_IPSEC_EXT.1, the TOE is required to implement RSA, ECDSA, or both
              for peer authentication.
              <br/>
              <br/>
              The generated key strength of 2048-bit RSA keys need to be equivalent to, or
              greater than, a symmetric key strength of 112 bits. See NIST Special Publication
              800-57, “Recommendation for Key Management” for information about
              equivalent key strengths.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall check to ensure that the TSS describes how the key-pairs are generated. In order to
                show that the TSF implementation complies with FIPS PUB 186-5, the evaluator shall ensure that the TSS
                contains the following information:
                <ul>
                  <li>The TSS shall list all sections of Appendix B to which the TOE complies</li>
                  <li>For each applicable section listed in the TSS, for all statements that are not "shall" (that is, "shall not,"
                    "should," and "should not"), if the TOE implements such options it shall be described in the TSS. If the
                    included functionality is indicated as "shall not" or "should not" in the standard, the TSS shall provide
                    a rationale for why this will not adversely affect the security policy implemented by the TOE</li>
                  <li>For each applicable section of Appendix B, any omission of functionality related to "shall" or “should”
                    statements shall be described</li>
                </ul>
                Any TOE-specific extensions, processing that is not included in the Appendices, or alternative
                implementations allowed by the Appendices that may impact the security requirements the TOE is to
                enforce shall be described.
                <br/>
              </TSS>
              <Guidance>
                The evaluator shall check that the operational guidance describes how the key generation functionality is
                invoked, and describes the inputs and outputs associated with the process for each signature scheme
                supported. The evaluator shall also check that guidance is provided regarding the format and location of
                the output of the key generation process.
                <br/>
              </Guidance>
              <Tests><b>For FFC Schemes using “safe-prime” groups:</b> <br/>Testing for FFC Schemes using safe-prime groups is done as part of testing in FCS_CKM.2. <br/> <b>For all other selections:</b> <br/>The evaluator shall perform the corresponding tests for FCS_CKM.1 specified in the NDcPP SD, based on the selections chosen for this SFR. If IKE key generation is implemented by a different algorithm than the NDcPP key generation function, the evaluator shall ensure this testing is performed using the correct implementation.</Tests>
            </aactivity>
          </f-element>
          <audit-event table="mandatory"/>
        </f-component>
      </section>
      <!-- 5.2.3 Security Management (FMT) -->
      <section title="Security Management (FMT)" id="fmt-mandatory">
        <!-- FMT_SMF.1/VPN Specification of Management Functions -->
        <f-component cc-id="fmt_smf.1" id="fmt-smf-1-vpn" name="Specification of Management Functions" iteration="VPN">
          <consistency-rationale>This SFR defines management functions that are specific to the functionality
          required by this PP-Module and were therefore not already defined in the
          Base-PP iteration of it.</consistency-rationale>
          <f-element id="fmt-smf-1e1-vpn">
            <title>
              The TSF shall be capable of performing the following management functions [<i>
                <ul>
                  <li>Definition of packet filtering rules</li>
                  <li>Association of packet filtering rules to network interfaces</li>
                  <li>Ordering of packet filtering rules by priority</li>
                </ul>
                <selectables linebreak="yes">
                  <selectable id="fmt_smf.1.1_VPN_1">Configuration of remote VPN client session timeout</selectable>
                  <selectable id="fmt_smf.1.1_VPN_2">Configuration of attributes used to deny establishment of remote VPN client sessions</selectable>
                  <selectable id="fmt_smf.1.1_VPN_3">Generation of bit-based pre-shared key</selectable>
                  <selectable id="fmt_smf.1.1_VPN_4" exclusive="yes">No other capabilities</selectable>
                </selectables></i>].
            </title>
            <note role="application">This SFR defines additional management functions for the TOE beyond what is
            defined in the Base-PP as FMT_SMF.1. The TOE may have all management
            functionality implemented in the same logical interface; it is not necessary for
            “network device management” and “VPN gateway management” to be
            implemented in separate interfaces.</note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to confirm that all management functions specified in
              FMT_SMF.1/VPN are provided by the TOE. As with FMT_SMF.1 in the Base-PP, the evaluator shall ensure
              that the TSS identifies what logical interfaces are used to perform these functions and that this includes a
              description of the local administrative interface.
                <br/>
              </TSS>
              <Guidance>
                The evaluator shall examine the operational guidance to confirm that all management functions specified
              in FMT_SMF.1/VPN are provided by the TOE. As with FMT_SMF.1 in the Base-PP, the evaluator shall
              ensure that the operational guidance identifies what logical interfaces are used to perform these functions
              and that this includes a description of the local administrative interface.
                <br/>
              </Guidance>
              <Tests>The evaluator tests management functions as part of performing other test EAs. No separate testing for FMT_SMF.1/VPN is required unless one of the management functions in FMT_SMF.1.1/VPN has not already been exercised under any other SFR.</Tests>
            </aactivity>
          </f-element>
          <audit-event table="mandatory">
            <audit-event-descr>All administrative actions</audit-event-descr>
            <audit-event-info>No additional information.</audit-event-info>
          </audit-event>
        </f-component>
      </section>
      <!-- 5.2.4 Packet Filtering (FPF) -->
      <section title="Packet Filtering (FPF)" id="fpf-mandatory">
        <class-description>This class contains families that describe packet filtering behavior. Packet filtering refers to the notion that
          network traffic that is transmitted through the TOE (i.e., the source and destination of the traffic is not
          the TOE but the TOE is on the routing path between these two entities) can be treated differently by the
          TSF based on attributes associated with the traffic. As this class is defined solely to contain an extended
          component defined for this PP-Module, it has two families, FPF_MFA_EXT and FPF_RUL_EXT.</class-description>
        <ext-comp-def title="Packet Filtering Rules" fam-id="FPF_RUL_EXT">
          <fam-behavior>This family defines the requirements for the rules that are used to perform packet filtering of network traffic.</fam-behavior>
        </ext-comp-def>
        <!-- FPF_RUL_EXT.1 Packet Filtering Rules -->
        <f-component cc-id="fpf_rul_ext.1" id="fpf-rul-ext-1" name="Packet Filtering Rules">
          <consistency-rationale>This SFR defines specific behavior for the processing of network traffic,
            specifically which communications channel is used based on certain
            attributes of the traffic. The Base-PP does not apply any constraints on how
            usage of a trusted channel is controlled so this does not contradict anything
            presented in the Base-PP.</consistency-rationale>
          <comp-lev>requires the TSF to enforce a given set of packet filtering rules
            in an administrator-defined order against one or more TOE interfaces.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT: <ul><li>Ability to configure the TOE’s packet filtering functionality (i.e., the operations to be performed on
              network traffic based on configured attributes, the interfaces that these are associated with, and the
              order in which they are applied).
            </li></ul></management>
          <audit>
            The following actions should be auditable if FAU_GEN Security audit data generation is included in the
            PP/ST:
            <ul>
              <li>Application of rules configured with the ‘log’ operation (including source and destination address,
                source and destination port, and transport layer protocol value).</li>
            </ul>
          </audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fpf-rul-ext-1e1">
            <title>The TSF shall perform packet filtering on network packets processed by the TOE.</title>
            <aactivity level="element">
              <TSS>
                The evaluator shall verify that the TSS provide a description of the TOE’s initialization and startup process,
                which clearly indicates where processing of network packets begins to take place, and provides a
                discussion that supports the assertion that packets cannot flow during this process.
                <br/>
                The evaluator shall verify that the TSS also includes a narrative that identifies the components (e.g., active
                entity such as a process or task) involved in processing the network packets and describes the safeguards
                that would prevent packets flowing through the TOE without applying the ruleset in the event of a
                component failure. This could include the failure of a component, such as a process being terminated, or
                a failure within a component, such as memory buffers full and cannot process packets.
                <br/>
              </TSS>
              <Guidance>
                The operational guidance associated with this requirement is assessed in the subsequent test EAs.
                <br/>
              </Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                  <test>The evaluator shall attempt to get network traffic to flow through the TOE while the TOE is being initialized. A steady flow of network packets that would otherwise be denied by the ruleset should be sourced and directed to a host. The evaluator shall use a packet sniffer to verify none of the generated network traffic is permitted through the TOE during initialization.</test>
                  <test>The evaluator shall attempt to get network traffic to flow through the TOE while the TOE is being initialized. A steady flow of network packets that would be permitted by the ruleset should be sourced and directed to a host. The evaluator shall use a packet sniffer to verify none of the generated network traffic is permitted through the TOE during initialization and is only permitted once initialization is complete.</test>
                </testlist>
                Note: The remaining testing associated with application of the ruleset is addressed in the subsequent test EAs.
                <br/>
              </Tests>
            </aactivity>
          </f-element>
          <f-element id="fpf-rul-ext-1e2">
            <title>
              The TSF shall allow the definition of packet filtering rules using the following
              network protocols and protocol fields: [<i>
                <ul>
                  <li>IPv4 (RFC 791)</li>
                  <ul>
                    <li>source address</li>
                    <li>destination address</li>
                    <li>protocol</li>
                  </ul>
                  <li>IPv6 (RFC 8200)</li>
                  <ul>
                    <li>source address</li>
                    <li>destination address</li>
                    <li>next header (protocol)</li>
                  </ul>
                  <li>TCP (RFC 793)</li>
                  <ul>
                    <li>source port</li>
                    <li>destination port</li>
                  </ul>
                  <li>UDP (RFC 768)</li>
                  <ul>
                    <li>source port</li>
                    <li>destination port</li>
                  </ul>
                </ul>
              </i>].
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall allow the definition of packet filtering rules using the following
                network protocols and protocol fields:
                <assignable>supported network protocols and protocol fields</assignable>.
              </title>
            </ext-comp-def-title>
            <note role="application">
              This element identifies the protocols and references the protocol definitions that
              serve to define to what extent the network traffic can be interpreted by the TOE
              when importing (receiving network traffic or ingress) and exporting (sending–or
              forming to be sent–network traffic or egress).
              <br/>
              While the protocol formatting specified in the RFCs is still used, many RFCs define
              behaviors which are no longer considered safe to follow. For example, RFC 792
              defined the “Redirect” Internet Control Message Protocol (ICMP) type, which is not considered safe to honor when it
              might come from an adversary; the “source quench” message, which is insecure
              because its source cannot be validated.
              <br/>
              It also identifies the various attributes that are applicable when constructing rules
              to be enforced by this requirement – the applicable interface is a property of the
              TOE and the rest of the identified attributes are defined in the associated RFCs.
              Note that the Protocol is the IPv4 field (in IPv6 this field is called the “next header”)
              that identifies the applicable protocol, such as TCP, UDP, ICMP, etc. Also,
              ‘Interface’ identified above is the external port where the applicable network
              traffic was received or alternately will be sent.
            </note>
            <aactivity level="element">
              <no-tests>
                There are no EAs specified for this element. Definition of packet filtering policy,
              association of operations with packet filtering rules, and association of these rules to network interfaces
              is described collectively under FPF_RUL_EXT.1.4.
                <br/>
                <br/>
              </no-tests>
            </aactivity>
          </f-element>
          <f-element id="fpf-rul-ext-1e3">
            <title>The TSF shall allow the following operations to be associated with packet filtering
              rules: permit and drop with the capability to log the operation.</title>
            <note role="application">This element defines the operations that can be associated with rules used to
              match network traffic.</note>
            <aactivity level="element">
              <no-tests>
                There are no EAs specified for this element. Definition of packet filtering policy,
              association of operations with packet filtering rules, and association of these rules to network interfaces
              is described collectively under FPF_RUL_EXT.1.4.
                <br/>
                <br/>
              </no-tests>
            </aactivity>
          </f-element>
          <f-element id="fpf-rul-ext-1e4">
            <title>The TSF shall allow the packet filtering rules to be assigned to each distinct
              network interface.</title>
            <note role="application">
              This element identifies where rules can be assigned. Specifically, a conforming TOE
              must be able to assign filtering rules specific to each of its available and
              identifiable distinct network interfaces that handle layer 3 and 4 network traffic.
              Identifiable means the interface is unique and identifiable within the TOE, and
              does not necessarily require the interface to be visible from the network
              perspective (e.g., does not need to have an IP address assigned to it). A distinct
              network interface is one or more physical connections that share a common
              logical path into the TOE. For example, the TOE might have a small form-factor
              pluggable (SFP) port supporting SFP modules that expose a number of physical
              network ports, but since a common driver is used for all external ports they can
              be treated as a single distinct network interface.
              <br/>
              Note that there could be a separate ruleset for each interface or alternately a
              shared ruleset that somehow associates rules with specific interfaces.
            </note>
            <aactivity level="element">
              <TSS>
                The evaluator shall verify that the TSS describes a packet filtering policy that can use the following fields
                for each identified protocol, and that the RFCs identified for each protocol are supported:
                <ul>
                  <li>IPv4 (RFC 791)</li>
                  <ul>
                    <li>source address</li>
                    <li>destination address</li>
                    <li>protocol</li>
                  </ul>
                  <li>IPv6 (RFC 8200)</li>
                  <ul>
                    <li>source address</li>
                    <li>destination address</li>
                    <li>next header (protocol)</li>
                  </ul>
                  <li>TCP (RFC 793)</li>
                  <ul>
                    <li>source port</li>
                    <li>destination port</li>
                  </ul>
                  <li>UDP (RFC 768)</li>
                  <ul>
                    <li>source port</li>
                    <li>destination port</li>
                  </ul>
                </ul>
                The evaluator shall verify that the TSS describes how conformance with the identified RFCs has been
                determined by the TOE developer (e.g., third party interoperability testing, protocol compliance testing).
                <br/>
                The evaluator shall verify that each rule can identify the following actions: permit, discard, and log.
                <br/>
                The evaluator shall verify that the TSS identifies all interface types subject to the packet filtering policy
                and explains how rules are associated with distinct network interfaces. Where interfaces can be grouped
                into a common interface type (e.g., where the same internal logical path is used, perhaps where a
                common device driver is used), they can be treated collectively as a distinct network interface.
                <br/>
              </TSS>
              <Guidance>
                The evaluator shall verify that the operational guidance identifies the following protocols as being
                supported and the following attributes as being configurable within packet filtering rules for the
                associated protocols:
                <ul>
                  <li>IPv4 (RFC 791)</li>
                  <ul>
                    <li>destination address</li>
                    <li>protocol</li>
                  </ul>
                  <li>IPv6 (RFC 8200)</li>
                  <ul>
                    <li>source address</li>
                    <li>destination address</li>
                    <li>next header (protocol)</li>
                  </ul>
                  <li>TCP (RFC 793)</li>
                  <ul>
                    <li>source port</li>
                    <li>destination port</li>
                  </ul>
                  <li>UDP (RFC 768)</li>
                  <ul>
                    <li>source port</li>
                    <li>destination port</li>
                  </ul>
                </ul>
                The evaluator shall verify that the operational guidance indicates that each rule can identify the following
                actions: permit, discard, and log.
                <br/>
                The evaluator shall verify that the operational guidance explains how rules are associated with distinct
                network interfaces.
                <br/>
                The guidance may describe the other protocols contained within the ST (e.g., IPsec, IKE, potentially HTTPS,
                SSH, and TLS) that are processed by the TOE. The evaluator shall ensure that it is made clear what
                protocols were not considered as part of the TOE evaluation.
                <br/>
              </Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                  <test>The evaluator shall use the instructions in the operational guidance to test that packet filter rules can be created that permit, discard, and log packets for each of the following attributes: <ul><li>IPv4</li> <ul><li>Destination Address</li> <li>Protocol</li></ul> <li>IPv6</li> <ul><li>Source address</li> <li>Destination Address</li> <li>Next Header (Protocol)</li></ul> <li>TCP</li> <ul><li>Source Port</li> <li>Destination Port</li></ul> <li>UDP</li> <ul><li>Source Port</li> <li>Destination Port</li></ul></ul></test>
                  <test>The evaluator shall repeat Test 1 above for each distinct network interface type supported by the TOE to ensure that packet filtering rules can be defined for all supported types.</test>
                </testlist>
                Note that these test activities should be performed in conjunction with those of FPF_RUL_EXT.1.6 where the effectiveness of the rules is tested; here the evaluator is just ensuring the guidance is sufficient and the TOE supports the administrator creating a ruleset based on the above attributes. The test activities for FPF_RUL_EXT.1.6 define the combinations of protocols and attributes required to be tested. If those combinations are configured manually, that will fulfill the objective of these test activities, but if those combinations are configured otherwise (e.g., using automation), these test activities may be necessary in order to ensure the guidance is correct and the full range of configurations can be achieved by a TOE administrator.
                <br/>
              </Tests>
            </aactivity>
          </f-element>
          <f-element id="fpf-rul-ext-1e5">
            <title>
              The TSF shall process the applicable packet filtering rules (as determined in
              accordance with FPF_RUL_EXT.1.4) in the following order: [<i>Administrator-defined</i>].
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall process the applicable packet filtering rules (as determined in
                accordance with FPF_RUL_EXT.1.4) in the following order:
                <assignable>rule processing order</assignable>.
              </title>
            </ext-comp-def-title>
            <note role="application">This element requires that an administrator is able to define the order in which
              configured filtering rules are processed for matches.</note>
            <aactivity level="element">
              <TSS>
                The evaluator shall verify that the TSS describes the algorithm applied to incoming packets, including the
                processing of default rules, determination of whether a packet is part of an established session, and
                application of administrator defined and ordered ruleset.
                <br/>
              </TSS>
              <Guidance>
                The evaluator shall verify that the operational guidance describes how the order of packet filtering rules
                is determined and provides the necessary instructions so that an administrator can configure the order of
                rule processing.
                <br/>
              </Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                  <test>The evaluator shall devise two equal packet filtering rules with alternate operations – permit and discard. The rules should then be deployed in two distinct orders and in each case the evaluator shall ensure that the first rule is enforced in both cases by generating applicable packets and using packet capture and logs for confirmation.</test>
                  <test>The evaluator shall repeat the procedure above, except that the two rules should be devised where one is a subset of the other (e.g., a specific address vs. a network segment). Again, the evaluator shall test both orders to ensure that the first is enforced regardless of the specificity of the rule.</test>
                </testlist>
                <br/>
              </Tests>
            </aactivity>
          </f-element>
          <f-element id="fpf-rul-ext-1e6">
            <title>The TSF shall drop traffic if a matching rule is not identified.</title>
            <note role="application">This element requires that the behavior is always to deny network traffic when no
              rules apply.</note>
            <aactivity level="element">
              <TSS>
                The evaluator shall verify that the TSS describes the process for applying packet filtering rules and also
                that the behavior (either by default, or as configured by the administrator) is to discard packets when
                there is no rule match. The evaluator shall verify the TSS describes when the IPv4 and IPv6 protocols supported by the TOE differ from the full list provided in the RFC Values for IPv4 and IPv6 table.
                <br/>
              </TSS>
              <Guidance>
                The evaluator shall verify that the operational guidance describes the behavior if no rules or special
                conditions apply to the network traffic. If the behavior is configurable, the evaluator shall verify that the
                operational guidance provides the appropriate instructions to configure the behavior to discard packets
                with no matching rules. The evaluator shall verify that the operational guidance describes the range of IPv4 and IPv6 protocols supported by the TOE.
                <br/>
              </Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                  <test>The evaluator shall configure the TOE to permit and log each supported IPv4 Transport Layer Protocol (see RFC Values for IPv4 and IPv6 table for full possible list) in conjunction with a specific source address and specific destination address, specific source address and wildcard destination address, wildcard source address and specific destination address, and wildcard source address and wildcard destination address. The evaluator shall generate packets matching each supported IPv4 Transport Layer Protocol and within the configured source and destination addresses in order to ensure that the supported protocols are permitted (i.e., by capturing the packets after passing through the TOE) and logged. Any protocols not supported by the TOE must be denied.</test>
                  <test>The evaluator shall configure the TOE to permit all traffic except to discard and log each supported IPv4 Transport Layer Protocol (see RFC Values for IPv4 and IPv6 table for full possible list) in conjunction with a specific source address and specific destination address, specific source address and wildcard destination address, wildcard source address and specific destination address, and wildcard source address and wildcard destination address. The evaluator shall generate packets matching each defined IPv4 Transport Layer Protocol and within the configured source and destination addresses in order to ensure that the supported protocols are denied (i.e., by capturing no applicable packets passing through the TOE) and logged. Any protocols not supported by the TOE must also be denied but are not required to be logged.</test>
                  <test>The evaluator shall configure the TOE to permit and log each supported IPv4 Transport Layer Protocol (see RFC Values for IPv4 and IPv6 table for full possible list) in conjunction with a specific source address and specific destination address, specific source address and wildcard destination address, wildcard source address and specific destination address, and wildcard source address and wildcard destination address. Additionally, the evaluator shall configure the TOE to discard and log each supported IPv4 Transport Layer Protocol (see RFC Values for IPv4 and IPv6 table for full possible list) in conjunction with different (than those permitted above) combinations of a specific source address and specific destination address, specific source address and wildcard destination address, wildcard source address and specific destination address, and wildcard source address and wildcard destination address. The evaluator shall generate packets matching each supported IPv4 Transport Layer Protocol and outside the scope of all source and destination addresses configured above in order to ensure that the supported protocols are denied (i.e., by capturing no applicable packets passing through the TOE) and logged. Any protocols not supported by the TOE must be denied.</test>
                  <test>The evaluator shall configure the TOE to permit and log each supported IPv6 Transport Layer Protocol (see RFC Values for IPv4 and IPv6 table for full possible list) in conjunction with a specific source address and specific destination address, specific source address and wildcard destination address, wildcard source address and specific destination address, and wildcard source address and wildcard destination address. The evaluator shall generate packets matching each defined IPv6 Transport Layer Protocol and within the configured source and destination addresses in order to ensure that the supported protocols are permitted (i.e., by capturing the packets after passing through the TOE) and logged. Any protocols not supported by the TOE must be denied.</test>
                  <test>The evaluator shall configure the TOE to permit all traffic except to discard and log each supported IPv6 Transport Layer Protocol (see RFC Values for IPv4 and IPv6 table for full possible list) in conjunction with a specific source address and specific destination address, specific source address and wildcard destination address, wildcard source address and specific destination address, and wildcard source address and wildcard destination address. The evaluator shall generate packets matching each defined IPv6 Transport Layer Protocol and within the configured source and destination addresses in order to ensure that the supported protocols are denied (i.e., by capturing no applicable packets passing through the TOE) and logged. Any protocols not supported by the TOE must also be denied but are not required to be logged.</test>
                  <test>The evaluator shall configure the TOE to permit and log each supported IPv6 Transport Layer Protocol (see RFC Values for IPv4 and IPv6 table for full possible list) in conjunction with a specific source address and specific destination address, specific source address and wildcard destination address, wildcard source address and specific destination address, and wildcard source address and wildcard destination address. Additionally, the evaluator shall configure the TOE to discard and log each supported IPv6 Transport Layer Protocol (see RFC Values for IPv4 and IPv6 table for full possible list) in conjunction with different (than those permitted above) combinations of a specific source address and specific destination address, specific source address and wildcard destination address, wildcard source address and specific destination address, and wildcard source address and wildcard destination address. The evaluator shall generate packets matching each defined IPv6 Transport Layer Protocol and outside the scope of all source and destination addresses configured above in order to ensure that the supported protocols are dropped (i.e., by capturing no applicable packets passing through the TOE) and logged. Any protocols not supported by the TOE must be denied.</test>
                  <test>The evaluator shall configure the TOE to permit and log protocol 6 (TCP) using a selected source port, a selected destination port, and a selected source and destination port combination. The evaluator shall generate packets matching the configured source and destination TCP ports in order to ensure that they are permitted (i.e., by capturing the packets after passing through the TOE) and logged.</test>
                  <test>The evaluator shall configure the TOE to discard and log protocol 6 (TCP) using a selected source port, a selected destination port, and a selected source and destination port combination. The evaluator shall generate packets matching the configured source and destination TCP ports in order to ensure that they are denied (i.e., by capturing no applicable packets passing through the TOE) and logged.</test>
                  <test>The evaluator shall configure the TOE to permit and log protocol 17 (UDP) using a selected source port, a selected destination port, and a selected source and destination port combination. The evaluator shall generate packets matching the configured source and destination UDP ports in order to ensure that they are permitted (i.e., by capturing the packets after passing through the TOE) and logged. Here the evaluator shall ensure that the UDP port 500 (IKE) is included in the set of tests.</test>
                  <test>The evaluator shall configure the TOE to discard and log protocol 17 (UDP) using a selected source port, a selected destination port, and a selected source and destination port combination. The evaluator shall generate packets matching the configured source and destination UDP ports in order to ensure that they are denied (i.e., by capturing no applicable packets passing through the TOE) and logged. Again, the evaluator shall ensure that UDP port 500 is included in the set of tests.</test>
                </testlist>
                The following table identifies the RFC defined values for the protocol fields for IPv4 and IPv6 to be used in configuring and otherwise testing packet filtering rule definition and enforcement:
                <br/>
                <table>
                  <tr class="header">
                    <td>Protocol</td>
                    <td>Defined Attributes</td>
                  </tr>
                  <tr>
                    <td>IPv4</td>
                    <td>
                      <ul>
                        <li>Transport Layer Protocol 1 - Internet Control Message</li>
                        <li>Transport Layer Protocol 2 - Internet Group Management</li>
                        <li>Transport Layer Protocol 3 - Gateway-to-Gateway</li>
                        <li>Transport Layer Protocol 4 - IP in IP (encapsulation)</li>
                        <li>Transport Layer Protocol 5 - Stream</li>
                        <li>Transport Layer Protocol 6 - Transmission Control</li>
                        <li>Transport Layer Protocol 7 - UCL</li>
                        <li>Transport Layer Protocol 8 - Exterior Gateway Protocol</li>
                        <li>Transport Layer Protocol 9 - Any private interior gateway</li>
                        <li>Transport Layer Protocol 10 - BBN RCC Monitoring</li>
                        <li>Transport Layer Protocol 11 - Network Voice Protocol</li>
                        <li>Transport Layer Protocol 12 - PUP</li>
                        <li>Transport Layer Protocol 13 - ARGUS</li>
                        <li>Transport Layer Protocol 14 - EMCON</li>
                        <li>Transport Layer Protocol 15 - Cross Net Debugger</li>
                        <li>Transport Layer Protocol 16 - Chaos</li>
                        <li>Transport Layer Protocol 17 - User Datagram</li>
                        <li>Transport Layer Protocol 18 - Multiplexing</li>
                        <li>Transport Layer Protocol 19 - DCN Measurement Subsystems</li>
                        <li>Transport Layer Protocol 20 - Host Monitoring</li>
                        <li>Transport Layer Protocol 21 - Packet Radio Measurement</li>
                        <li>Transport Layer Protocol 22 - XEROX NS IDP</li>
                        <li>Transport Layer Protocol 23 - Trunk-1</li>
                        <li>Transport Layer Protocol 24 - Trunk-2</li>
                        <li>Transport Layer Protocol 25 - Leaf-1</li>
                        <li>Transport Layer Protocol 26 - Leaf-2</li>
                        <li>Transport Layer Protocol 27 - Reliable Data Protocol</li>
                        <li>Transport Layer Protocol 28 - Internet Reliable Transaction</li>
                        <li>Transport Layer Protocol 29 - ISO Transport Protocol Class 4</li>
                        <li>Transport Layer Protocol 30 - Bulk Data Transfer Protocol</li>
                        <li>Transport Layer Protocol 31 - MFE Network Services Protocol</li>
                        <li>Transport Layer Protocol 32 - MERIT Internodal Protocol</li>
                        <li>Transport Layer Protocol 33 - Sequential Exchange Protocol</li>
                        <li>Transport Layer Protocol 34 - Third Party Connect Protocol</li>
                        <li>Transport Layer Protocol 35 - Inter-Domain Policy Routing Protocol</li>
                        <li>Transport Layer Protocol 36 - XTP</li>
                        <li>Transport Layer Protocol 37 - Datagram Delivery Protocol</li>
                        <li>Transport Layer Protocol 38 - IDPR Control Message Transport Protocol</li>
                        <li>Transport Layer Protocol 39 - TP++ Transport Protocol</li>
                        <li>Transport Layer Protocol 40 - IL Transport Protocol</li>
                        <li>Transport Layer Protocol 41 - Simple Internet Protocol</li>
                        <li>Transport Layer Protocol 42 - Source Demand Routing Protocol</li>
                        <li>Transport Layer Protocol 43 - SIP Source Route</li>
                        <li>Transport Layer Protocol 44 - SIP Fragment</li>
                        <li>Transport Layer Protocol 45 - Inter-Domain Routing Protocol</li>
                        <li>Transport Layer Protocol 46 - Reservation Protocol</li>
                        <li>Transport Layer Protocol 47 - General Routing Encapsulation</li>
                        <li>Transport Layer Protocol 48 - Mobile Host Routing Protocol</li>
                        <li>Transport Layer Protocol 49 - BNA</li>
                        <li>Transport Layer Protocol 50 - SIPP Encap Security Payload</li>
                        <li>Transport Layer Protocol 51 - SIPP Authentication Header</li>
                        <li>Transport Layer Protocol 52 - Integrated Net Layer Security TUBA</li>
                        <li>Transport Layer Protocol 53 - IP with Encryption</li>
                        <li>Transport Layer Protocol 54 - NBMA Next Hop Resolution Protocol</li>
                        <li>Transport Layer Protocol 61 - Any host internal protocol</li>
                        <li>Transport Layer Protocol 62 - CFTP</li>
                        <li>Transport Layer Protocol 63 - Any local network</li>
                        <li>Transport Layer Protocol 64 - SATNET and Backroom EXPAK</li>
                        <li>Transport Layer Protocol 65 - Kryptolan</li>
                        <li>Transport Layer Protocol 66 - MIT Remote Virtual Disk Protocol</li>
                        <li>Transport Layer Protocol 67 - Internet Pluribus Packet Core</li>
                        <li>Transport Layer Protocol 68 - Any distributed file system</li>
                        <li>Transport Layer Protocol 69 - SATNET Monitoring</li>
                        <li>Transport Layer Protocol 70 - VISA Protocol</li>
                        <li>Transport Layer Protocol 71 - Internet Packet Core Utility</li>
                        <li>Transport Layer Protocol 72 - Computer Protocol Network Executive</li>
                        <li>Transport Layer Protocol 73 - Computer Protocol Heart Beat</li>
                        <li>Transport Layer Protocol 74 - Wang Span Network</li>
                        <li>Transport Layer Protocol 75 - Packet Video Protocol</li>
                        <li>Transport Layer Protocol 76 - Backroom SATNET Monitoring</li>
                        <li>Transport Layer Protocol 77 - SUN ND PROTOCOL-Temporary</li>
                        <li>Transport Layer Protocol 78 - WIDEBAND Monitoring</li>
                        <li>Transport Layer Protocol 79 - WIDEBAND EXPAK</li>
                        <li>Transport Layer Protocol 80 - ISO Internet Protocol</li>
                        <li>Transport Layer Protocol 81 - VMTP</li>
                        <li>Transport Layer Protocol 82 - SECURE-VMTP</li>
                        <li>Transport Layer Protocol 83 - VINES</li>
                        <li>Transport Layer Protocol 84 - TTP</li>
                        <li>Transport Layer Protocol 85 - NSFNET-IGP</li>
                        <li>Transport Layer Protocol 86 - Dissimilar Gateway Protocol</li>
                        <li>Transport Layer Protocol 87 - TCF</li>
                        <li>Transport Layer Protocol 88 - IGRP</li>
                        <li>Transport Layer Protocol 89 - OSPFIGP</li>
                        <li>Transport Layer Protocol 90 - Sprite RPC Protocol</li>
                        <li>Transport Layer Protocol 91 - Locus Address Resolution Protocol</li>
                        <li>Transport Layer Protocol 92 - Multicast Transport Protocol</li>
                        <li>Transport Layer Protocol 93 - AX.25 Frames</li>
                        <li>Transport Layer Protocol 94 - IP-within-IP Encapsulation Protocol</li>
                        <li>Transport Layer Protocol 95 - Mobile Internetworking Control Protocol</li>
                        <li>Transport Layer Protocol 96 - Semaphore Communications Security Protocol</li>
                        <li>Transport Layer Protocol 97 - Ethernet-within-IP Encapsulation</li>
                        <li>Transport Layer Protocol 98 - Encapsulation Header</li>
                        <li>Transport Layer Protocol 99 - Any private encryption scheme</li>
                        <li>Transport Layer Protocol 100 - GMTP</li>
                      </ul>
                    </td>
                  </tr>
                  <tr>
                    <td>IPv6</td>
                    <td>
                      <ul>
                        <li>Transport Layer Protocol 1 - Internet Control Message</li>
                        <li>Transport Layer Protocol 2 - Internet Group Management</li>
                        <li>Transport Layer Protocol 3 - Gateway-to-Gateway</li>
                        <li>Transport Layer Protocol 4 - IPv4 encapsulation</li>
                        <li>Transport Layer Protocol 5 - Stream</li>
                        <li>Transport Layer Protocol 6 - Transmission Control</li>
                        <li>Transport Layer Protocol 7 - CBT</li>
                        <li>Transport Layer Protocol 8 - Exterior Gateway Protocol</li>
                        <li>Transport Layer Protocol 9 - Any private interior gateway</li>
                        <li>Transport Layer Protocol 10 - BBN RCC Monitoring</li>
                        <li>Transport Layer Protocol 11 - Network Voice Protocol</li>
                        <li>Transport Layer Protocol 12 - PUP</li>
                        <li>Transport Layer Protocol 13 - ARGUS</li>
                        <li>Transport Layer Protocol 14 - EMCON</li>
                        <li>Transport Layer Protocol 15 - Cross Net Debugger</li>
                        <li>Transport Layer Protocol 16 - Chaos</li>
                        <li>Transport Layer Protocol 17 - User Datagram</li>
                        <li>Transport Layer Protocol 18 - Multiplexing</li>
                        <li>Transport Layer Protocol 19 - DCN Measurement Subsystems</li>
                        <li>Transport Layer Protocol 20 - Host Monitoring</li>
                        <li>Transport Layer Protocol 21 - Packet Radio Measurement</li>
                        <li>Transport Layer Protocol 22 - XEROX NS IDP</li>
                        <li>Transport Layer Protocol 23 - Trunk-1</li>
                        <li>Transport Layer Protocol 24 - Trunk-2</li>
                        <li>Transport Layer Protocol 25 - Leaf-1</li>
                        <li>Transport Layer Protocol 26 - Leaf-2</li>
                        <li>Transport Layer Protocol 27 - Reliable Data Protocol</li>
                        <li>Transport Layer Protocol 28 - Internet Reliable Transaction</li>
                        <li>Transport Layer Protocol 29 - Transport Protocol Class 4</li>
                        <li>Transport Layer Protocol 30 - Bulk Data Transfer Protocol</li>
                        <li>Transport Layer Protocol 31 - MFE Network Services Protocol</li>
                        <li>Transport Layer Protocol 32 - MERIT Internodal Protocol</li>
                        <li>Transport Layer Protocol 33 - Datagram Congestion Control Protocol</li>
                        <li>Transport Layer Protocol 34 - Third Party Connect Protocol</li>
                        <li>Transport Layer Protocol 35 - Inter-Domain Policy Routing Protocol</li>
                        <li>Transport Layer Protocol 36 - XTP</li>
                        <li>Transport Layer Protocol 37 - Datagram Delivery Protocol</li>
                        <li>Transport Layer Protocol 38 - IDPR Control Message Transport Protocol</li>
                        <li>Transport Layer Protocol 39 - TP++ Transport Protocol</li>
                        <li>Transport Layer Protocol 40 - IL Transport Protocol</li>
                        <li>Transport Layer Protocol 41 - IPv6 encapsulation</li>
                        <li>Transport Layer Protocol 42 - Source Demand Routing Protocol</li>
                        <li>Transport Layer Protocol 43 - Intentionally blank</li>
                        <li>Transport Layer Protocol 44 - Intentionally blank</li>
                        <li>Transport Layer Protocol 45 - Inter-Domain Routing Protocol</li>
                        <li>Transport Layer Protocol 46 - Reservation Protocol</li>
                        <li>Transport Layer Protocol 47 - General Routing Encapsulation</li>
                        <li>Transport Layer Protocol 48 - Dynamic Source Routing Protocol</li>
                        <li>Transport Layer Protocol 49 - BNA</li>
                        <li>Transport Layer Protocol 50 - Intentionally Blank</li>
                        <li>Transport Layer Protocol 51 - Intentionally Blank</li>
                        <li>Transport Layer Protocol 52 - Integrated Net Layer Security</li>
                        <li>Transport Layer Protocol 53 - IP with Encryption</li>
                        <li>Transport Layer Protocol 54 - NBMA Address Resolution Protocol</li>
                        <li>Transport Layer Protocol 55 - Mobility</li>
                        <li>Transport Layer Protocol 56 - Transport Layer Security Protocol using Kryptonet key
                        management</li>
                        <li>Transport Layer Protocol 57 - SKIP</li>
                        <li>Transport Layer Protocol 58 - ICMP for IPv6</li>
                        <li>Transport Layer Protocol 59 - No Next Header for IPv6</li>
                        <li>Transport Layer Protocol 60 - Intentionally Blank</li>
                        <li>Transport Layer Protocol 61 - Any host internal protocol</li>
                        <li>Transport Layer Protocol 62 - CFTP</li>
                        <li>Transport Layer Protocol 63 - Any local network</li>
                        <li>Transport Layer Protocol 64 - SATNET and Backroom EXPAK</li>
                        <li>Transport Layer Protocol 65 - Kryptolan</li>
                        <li>Transport Layer Protocol 66 - MIT Remote Virtual Disk Protocol</li>
                        <li>Transport Layer Protocol 67 - Internet Pluribus Packet Core</li>
                        <li>Transport Layer Protocol 68 - Any distributed file system</li>
                        <li>Transport Layer Protocol 69 - SATNET Monitoring</li>
                        <li>Transport Layer Protocol 70 - VISA Protocol</li>
                        <li>Transport Layer Protocol 71 - Internet Packet Core Utility</li>
                        <li>Transport Layer Protocol 72 - Computer Protocol Network Executive</li>
                        <li>Transport Layer Protocol 73 - Computer Protocol Heart Beat</li>
                        <li>Transport Layer Protocol 74 - Wang Span Network</li>
                        <li>Transport Layer Protocol 75 - Packet Video Protocol</li>
                        <li>Transport Layer Protocol 76 - Backroom SATNET Monitoring</li>
                        <li>Transport Layer Protocol 77 - SUN ND PROTOCOL-Temporary</li>
                        <li>Transport Layer Protocol 78 - WIDEBAND Monitoring</li>
                        <li>Transport Layer Protocol 79 - WIDEBAND EXPAK</li>
                        <li>Transport Layer Protocol 80 - ISO Internet Protocol</li>
                        <li>Transport Layer Protocol 81 - VMTP</li>
                        <li>Transport Layer Protocol 82 - SECURE-VMTP</li>
                        <li>Transport Layer Protocol 83 - VINES</li>
                        <li>Transport Layer Protocol 84 - TTP</li>
                        <li>Transport Layer Protocol 85 - Internet Protocol Traffic Manager</li>
                        <li>Transport Layer Protocol 86 - NSFNET-IGP</li>
                        <li>Transport Layer Protocol 87 - Dissimilar Gateway Protocol</li>
                        <li>Transport Layer Protocol 88 - TCF</li>
                        <li>Transport Layer Protocol 89 - EIGRP</li>
                        <li>Transport Layer Protocol 90 - OSPFIGP</li>
                        <li>Transport Layer Protocol 91 - Sprite RPC Protocol</li>
                        <li>Transport Layer Protocol 92 - Locus Address Resolution Protocol</li>
                        <li>Transport Layer Protocol 93 - Multicast Transport Protocol</li>
                        <li>Transport Layer Protocol 94 - AX.25 Frames</li>
                        <li>Transport Layer Protocol 95 - IP-within-IP Encapsulation Protocol</li>
                        <li>Transport Layer Protocol 96 - Mobile Internetworking Control Pro.</li>
                        <li>Transport Layer Protocol 97 - Semaphore Communications Sec. Pro.</li>
                        <li>Transport Layer Protocol 98 - Ethernet-within-IP Encapsulation</li>
                        <li>Transport Layer Protocol 99 - Encapsulation Header</li>
                        <li>Transport Layer Protocol 100 - GMTP</li>
                        <li>Transport Layer Protocol 101 - Ipsilon Flow Management Protocol</li>
                        <li>Transport Layer Protocol 102 - PNNI over IP</li>
                        <li>Transport Layer Protocol 103 - Protocol Independent Multicast</li>
                        <li>Transport Layer Protocol 104 - ARIS</li>
                        <li>Transport Layer Protocol 105 - SCPS Transport Layer Protocol</li>
                        <li>Transport Layer Protocol 106 - QNX</li>
                        <li>Transport Layer Protocol 107 - Active Networks</li>
                        <li>Transport Layer Protocol 108 - Payload Compression Protocol</li>
                        <li>Transport Layer Protocol 109 - Sitara Networks Protocol</li>
                        <li>Transport Layer Protocol 110 - Compaq Peer Protocol</li>
                        <li>Transport Layer Protocol 111 - IPX in IP</li>
                        <li>Transport Layer Protocol 112 - Virtual Router Redundancy Protocol</li>
                        <li>Transport Layer Protocol 113 - PGM Reliable Transport Protocol</li>
                        <li>Transport Layer Protocol 114 - Any 0-hop protocol</li>
                        <li>Transport Layer Protocol 115 - Layer Two Tunneling Protocol</li>
                        <li>Transport Layer Protocol 116 - D-II Data Exchange (DDX)</li>
                        <li>Transport Layer Protocol 117 - Interactive Agent Transfer Protocol</li>
                        <li>Transport Layer Protocol 118 - Schedule Transfer Protocol</li>
                        <li>Transport Layer Protocol 119 - SpectraLink Radio Protocol</li>
                        <li>Transport Layer Protocol 120 - UTI</li>
                        <li>Transport Layer Protocol 121 - Simple Message Protocol</li>
                        <li>Transport Layer Protocol 122 - SM</li>
                        <li>Transport Layer Protocol 123 - Performance Transparency Protocol</li>
                        <li>Transport Layer Protocol 124 - ISIS over IPv4</li>
                        <li>Transport Layer Protocol 125 - FIRE</li>
                        <li>Transport Layer Protocol 126 - Combat Radio Transport Protocol</li>
                        <li>Transport Layer Protocol 127 - Combat Radio User Datagram</li>
                        <li>Transport Layer Protocol 128 - SSCOPMCE</li>
                        <li>Transport Layer Protocol 129 - IPLT</li>
                        <li>Transport Layer Protocol 130 - Secure Packet Shield</li>
                        <li>Transport Layer Protocol 131 - Private IP Encapsulation within IP</li>
                        <li>Transport Layer Protocol 132 - Stream Control Transmission Protocol</li>
                        <li>Transport Layer Protocol 133 - Fibre Channel</li>
                        <li>Transport Layer Protocol 134 - RSVP-E2E-IGNORE</li>
                        <li>Transport Layer Protocol 135 - Mobility Header</li>
                        <li>Transport Layer Protocol 136 - UDPLite</li>
                        <li>Transport Layer Protocol 137 - MPLS-in-IP</li>
                        <li>Transport Layer Protocol 138 - MANET Protocols</li>
                        <li>Transport Layer Protocol 139 - Host Identity Protocol</li>
                        <li>Transport Layer Protocol 140 - Shim6 Protocol</li>
                        <li>Transport Layer Protocol 141 - Wrapped Encapsulating Security Payload</li>
                        <li>Transport Layer Protocol 142 - Robust Header Compression</li>
                      </ul>
                    </td>
                  </tr>
                </table>
                <b>
                  <ctr ctr-type="Table" id="rfcvalues">: RFC Values for IPv4 and IPv6</ctr>
                </b>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event table="mandatory">
            <audit-event-descr>Application of rules configured with the 'log' operation</audit-event-descr>
            <audit-event-info>Source and destination addresses</audit-event-info>
            <audit-event-info>Source and destination ports</audit-event-info>
            <audit-event-info>Transport layer protocol</audit-event-info>
          </audit-event>
        </f-component>
      </section>
      <!-- 5.2.5 Protection of the TSF (FPT) -->
      <section title="Protection of the TSF (FPT)" id="fpt-mandatory">
        <ext-comp-def title="TSF Self-Test" fam-id="FPT_TST_EXT">
          <fam-behavior>This family is defined in the Base-PP. This PP-Module augments the extended family by adding one additional component, FPT_TST_EXT.3. This new component and its impact on the extended family’s component leveling are shown below; reference the Base-PP for all other definitions for this family.</fam-behavior>
        </ext-comp-def>
        <!-- FPT_FLS.1/SelfTest Failure with Preservation of Secure State (Self-Test Failures) -->
        <f-component cc-id="fpt_fls.1" id="fpt-fls-1" name="Failure with Preservation of Secure State (Self-Test Failures)" iteration="SelfTest">
          <consistency-rationale>The Base-PP already requires the TOE to specify the self-tests that are
            performed. This PP-Module simply goes one step further and requires the
            TSF to behave in a certain way upon failure of those self-tests.</consistency-rationale>
          <f-element id="fpt-fls-1e1-SelfTest">
            <title>The TSF shall <s>preserve a secure state </s><b>shut down</b> when the following types of failures occur: [<i>failure of the
              power-on self-tests, failure of integrity check of the TSF executable image, failure
              of noise source health tests</i>].</title>
            <note role="application">This SFR defines the expected TSF response to failures of the self-tests defined in
              the Base-PP.</note>
            <aactivity>
              <TSS>
                The evaluator shall ensure the TSS describes how the TOE ensures a shutdown upon a self-test failure, a
                failed integrity check of the TSF executable image, or a failed health test of the noise source. If there are
                instances when a shutdown does not occur, (e.g., a failure is deemed non-security relevant), the
                evaluator shall ensure that those cases are identified and a rationale is provided that supports the
                classification and justifies why the TOE’s ability to enforce its security policies is not affected in any such
                instance.
                <br/>
              </TSS>
              <Guidance>
                The evaluator shall verify that the operational guidance provides information on the self-test failures that
                can cause the TOE to shut down and how to diagnose the specific failure that has occurred, including
                possible remediation steps if available.
                <br/>
              </Guidance>
              <Tests>There are no test EAs for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event table="mandatory"/>
        </f-component>
        <!-- FPT_TST_EXT.3 Self-Test with Defined Methods -->
        <f-component cc-id="fpt_tst_ext.3" id="fpt-tst-ext-3" name="Self-Test with Defined Methods">
          <consistency-rationale>This PP-Module adds to the self-testing requirements from the Base-PP by
            mandating that a specific self-test be performed and that it be performed in
            a certain manner. This does not conflict with the Base-PP because the
            method used to perform the self-test is a cryptographic function already
            mandated by the Base-PP.</consistency-rationale>
          <comp-lev>requires the TSF to specify the methods by
            which self-testing is performed in addition to identifying the self-tests that are executed and the
            circumstances in which this execution occurs.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          <f-element id="fpt-tst-ext-3e1">
            <title>
              The TSF shall run a suite of the following self-tests [<i>when loaded for execution</i>]
              to demonstrate the correct operation of the TSF: [<i>integrity verification of stored
              executable code</i>].
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall run a suite of the following self-tests
                <assignable>timing when self-testing is run</assignable>
                to demonstrate the correct operation of the TSF:
                <assignable>list of self-tests performed</assignable>.
              </title>
            </ext-comp-def-title>
          </f-element>
          <f-element id="fpt-tst-ext-3e2">
            <title>The TSF shall execute the self-testing through [<i>a TSF-provided cryptographic
              service specified in FCS_COP.1/SigGen (from <xref to="bibNDcPP"/>)</i>].</title>
            <ext-comp-def-title>
              <title>The TSF shall execute the self-testing through <assignable>self-testing mechanism</assignable>.</title>
            </ext-comp-def-title>
            <note role="application">This requirement expands upon the self-test requirements defined in the NDcPP
              by specifying the method by which one of the self-tests is to be performed. “Stored
              TSF executable code” refers to the entire software image of the device and not
              just the code related to the VPN gateway functionality defined by this PP-Module.</note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS describes the method used to perform self-testing on the TSF
                executable code, and that this method is consistent with what is described in the SFR.
                <br/>
              </TSS>
              <Guidance>There are no guidance EAs for this component.<br/></Guidance>
              <Tests>There are no test EAs for this component.</Tests>
            </aactivity>
          </f-element>
          <audit-event table="mandatory"/>
        </f-component>
      </section>
      <!-- 5.2.6 Trusted Path/Channels (FTP) -->
      <section title="Trusted Path/Channels (FTP)" id="ftp-mandatory">
        <!-- FTP_ITC.1/VPN Inter-TSF Trusted Channel (VPN Communications) -->
        <f-component cc-id="ftp_itc.1" id="ftp-itc-1-vpn" name="Inter-TSF Trusted Channel (VPN Communications)" iteration="VPN">
          <consistency-rationale>This PP-Module iterates a Base-PP SFR to refer to an interface that is unique
            to the PP-Module. This does not affect the ability of the Base-PP iteration of
            the SFR to be satisfied.</consistency-rationale>
          <f-element id="ftp-itc-1e1-vpn">
            <title>
              The TSF shall
              <b>be capable of using IPsec to</b>
              provide a communication channel
              between itself and
              <b>authorized IT entities supporting VPN communications</b>
              that
              is logically distinct from other communication channels and provides assured
              identification of its end points and protection of the channel data from
              <b>disclosure
                and detection of modification of the channel data</b>.
            </title>
          </f-element>
          <f-element id="ftp-itc-1e2-vpn">
            <title>
              The TSF shall permit [<i>the authorized IT entities</i>] to initiate communication via the
              trusted channel.
            </title>
          </f-element>
          <f-element id="ftp-itc-1e3-vpn">
            <title>
              The TSF shall initiate communication via the trusted channel for
              <selectables onlyone="yes">
                <selectable id="ftp_itc.1.3_VPN_1">remote VPN gateways or peers</selectable>
                <selectable id="ftp_itc.1.3_VPN_2">no functions</selectable>
              </selectables>.
            </title>
            <note role="application">The FTP_ITC.1 requirement in the Base-PP relates to other trusted channel
            functions. This iteration is specific to IPsec VPN communications.</note>
            <aactivity>
              <TSS>
                The EAs specified for FTP_ITC.1 in the Supporting Document for the Base-PP shall be
                applied for IPsec VPN communications.
                <br/>
              </TSS>
              <Guidance>
                The EAs specified for FTP_ITC.1 in the Supporting Document for the Base-PP shall be
                applied for IPsec VPN communications.
                <br/>
              </Guidance>
              <Tests>The EAs specified for FTP_ITC.1 in the Supporting Document for the Base-PP shall be applied for IPsec VPN communications. Additional testing for IPsec is covered in FCS_IPSEC_EXT.1.</Tests>
            </aactivity>
          </f-element>
          <audit-event table="mandatory">
            <audit-event-descr>Initiation of the trusted channel</audit-event-descr>
            <audit-event-info>No additional information.</audit-event-info>
          </audit-event>
          <audit-event table="mandatory">
            <audit-event-descr>Termination of the trusted channel</audit-event-descr>
            <audit-event-info>No additional information.</audit-event-info>
          </audit-event>
          <audit-event table="mandatory">
            <audit-event-descr>Failure of the trusted channel functions</audit-event-descr>
            <audit-event-info>Identification of the initiator and target of failed trusted channel establishment attempt</audit-event-info>
          </audit-event>
        </f-component>
      </section>
    </man-sfrs>
    <opt-sfrs>
      <section id="sop-audit-table" title="Auditable Events for Strictly Optional SFRs">
        <audit-table id="opt-audit-events" table="optional"/>
      </section>
      <!-- 5.2.7 Packet Filtering (FPF) -->
      <section title="Packet Filtering (FPF)" id="fpf-optional">
        The TOE may support multifactor authentication by blocking all other traffic after connection is established until secondary authentication is validated.
        <ext-comp-def title="Multifactor Authentication Filtering" fam-id="FPF_MFA_EXT">
          <fam-behavior>Components in this family describe the requirements for multifactor authentication filtering when using the VPN client.</fam-behavior>
        </ext-comp-def>
        <!-- FPF_MFA_EXT.1 Multifactor Authentication Filtering -->
        <f-component cc-id="fpf_mfa_ext.1" id="fpf-mfa-ext-1" name="Multifactor Authentication Filtering">
          <depends>
            <optional/>
          </depends>
          <consistency-rationale>This SFR relates specifically to the handling of traffic that is used for the establishment of IPsec connections.</consistency-rationale>
          <comp-lev>defines the use and composition of multifactor authentication filtering.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <f-element id="fpf-mfa-ext-1e1">
            <title>The TSF shall not forward packets to the internal network until the IKE tunnel has been established, 
              except those necessary to verify additional authentication factors of the client.</title>
          </f-element>
          <f-element id="fpf-mfa-ext-1e2">
            <title>
              The TSF shall
              <selectables>
                <selectable id="sel-tsf-mfa">verify</selectable>
                <selectable id="fpf_mfa_ext.1.2_1">verify via an external authentication server</selectable>
              </selectables>
              additional authentication factors of the client.
            </title>
            <note role="application">If "verify" is selected, FIA_PSK_EXT.1 must be claimed.</note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to verify that it describes how authentication packets are identified 
                and how all other traffic is blocked until secondary authentication is successful.
                <br/>
                <br/>
                If the selection “verify” is included, the evaluator shall examine the TSS and verify it describes each authentication factor supported.
                <br/>
                <br/>
                If the selection “verify via an external authentication server” is included, the evaluator shall examine the TSS and verify it describes how the factors are forwarded to the authentication server. 
                The evaluator shall confirm other traffic is denied until verification is received by the authentication server.
                <br/>
              </TSS>
              <Guidance>
                The evaluator shall examine the operational guidance to verify that it provides instructions to the 
                administrator on how to configure the secondary authentication factors and any additional details necessary for filtering all other traffic.
                <br/>
                <br/>
                If the selection “verify via an external authentication server” is included, 
                the evaluator shall examine the operational guidance to verify that it provides instructions to the administrator 
                on how to integrate the authentication server.
                <br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>For each accepted authentication factor, the evaluator shall configure the TOE in accordance with the operational guidance. The evaluator shall attempt to connect and verify other traffic is rejected per the filtering rules. The evaluator shall then provide the authentication factor and confirm it is accepted and that traffic is no longer blocked.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event table="optional"/>
        </f-component>
      </section>
    </opt-sfrs>
    <sel-sfrs>
      <section id="sb-audit-table" title="Auditable Events for Selection-based SFRs">
        <audit-table id="sel-audit-events" table="sel-based"/>
      </section>
      <!-- 5.2.8 Cryptographic Support (FCS) -->
      <section title="Cryptographic Support (FCS)" id="fcs-selectionBased">
        <ext-comp-def title="EAP-TLS/TTLS" fam-id="FCS_EAP_EXT">
          <fam-behavior>Components in this family describe the requirements for EAP-TLS/TTLS.</fam-behavior>
        </ext-comp-def>
        <!-- FCS_EAP_EXT.1 EAP-TLS/TTLS -->
        <f-component cc-id="fcs_eap_ext.1" id="fcs-eap-ext-1" name="EAP-TLS/TTLS">
          <depends on-sel="sel-ipsec-e13-eaptls"/>
          <depends on-sel="sel-ipsec-e13-psk"/>
          <depends on-sel="sel-ipsec-e13-eapttls"/>
          <consistency-rationale>This SFR defines the use of EAP-TLS/TTLS; the Base-PP already defines requirements for TLS so potential support for EAP-TLS is consistent with functionality that the Base-PP already expects the TOE may have.</consistency-rationale>
          <comp-lev>defines the use of EAP-TLS/TTLS.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FCS_IPSEC_EXT.1 IPsec Protocol</dependencies>
          <f-element id="fcs-eap-ext-1e1">
            <title>
              The TSF shall support
              <selectables>
                <selectable id="fcs_eap_ext.1.1_1">EAP-TLS as specified in RFC 5216 and updated by RFC 8996</selectable>
                <selectable id="fcs_eap_ext.1.1_2">EAP-TTLS as specified in RFC 5281 and updated by RFC 8996</selectable>
              </selectables>
              over a protected channel per FTP_ITC.1
              <b>from the Base-PP</b>
              with an authentication server.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall support
                <selectables>
                  <selectable>EAP-TLS as specified in RFC 5216 and updated by RFC 8996</selectable>
                  <selectable>EAP-TTLS as specified in RFC 5281 and updated by RFC 8996</selectable>
                </selectables>
                over a protected channel per FTP_ITC.1 with an authentication server.
              </title>
            </ext-comp-def-title>
          </f-element>
          <f-element id="fcs-eap-ext-1e2">
            <title>The TSF shall implement EAP-TLS or EAP-TTLS with the TSF as the EAP client, 
              an authentication server as the EAP server, and the VPN peer as the supplicant.</title>
          </f-element>
          <f-element id="fcs-eap-ext-1e3">
            <title>
              The TSF shall use the MSK from the
              <selectables>
                <selectable id="fcs_eap_ext.1.3_1">EAP-TLS</selectable>
                <selectable id="fcs_eap_ext.1.3_2">EAP-TTLS</selectable>
              </selectables>
              response as the IKEv2 shared secret in the authentication payload.
            </title>
            <note role="application">This SFR covers the EAP requirements for a client connection to an authentication server. 
              In particular, authentication server functionality implemented in the same device, 
              rather than in an external device, is covered under the Authentication Server PP-Module, and is out of scope for this PP-Module. 
              The MSK derived from EAP is distinct from the PSK. The MSK is substituted in for the IKEv2 shared secret in the AUTH computations.</note>
            <aactivity>
              <TSS>
                The evaluator shall verify that the TSS describes the use of EAP options for each of the selected peer authentication 
                mechanisms, and that the TSF supports EAP messaging for mutually authenticated TLS between the peer and the authentication server.
                <br/>
              </TSS>
              <Guidance>
                The evaluator shall verify that the guidance documents describe any configurable features of the EAP or TLS 
                functionality, including instructions for configuration of the authenticators and registration processes for clients.
                <br/>
              </Guidance>
              <Tests>
                Testing for TLS functionality is in accordance with the TLS package.
                <b></b>
                For each supported EAP method claimed in FCS_EAP_EXT.1.1 and for each authentication method claimed in FCS_EAP_EXT.1.3, the evaluator shall perform the following tests:
                <testlist>
                  <test>The evaluator shall follow the operational guidance to configure the TSF to use the EAP method claimed. The evaluator shall follow the operational guidance to configure the TSF to use the authentication method claimed and, for EAP-TTLS, establish a trusted channel with an authentication server that requests the method, and register the peer as a TLS client with appropriate key material required for the authentication method. <br/>  <br/> The evaluator shall establish a VPN session using a test peer with a valid certificate and, for EAP-TTLS, configured to provide a correct value for the configured authenticator. The evaluator shall observe that the TSF sends EAP messages to the peer and authentication server to transfer the TLS handshake messages, and after the TSF receives the EAP-success message, that the VPN session between the peer and TSF is successfully established.</test>
                  <test>The evaluator shall follow the operational guidance to configure the TSF to use a supported EAP method, establish a trusted channel with an authentication server that requests the method and register the peer as a TLS client with key material required for a supported authentication method. The evaluator shall cause the test client to respond to an IKEv2 exchange with EAP-request, but to compute the shared secret after a successful EAP exchange using the non-EAP method. The evaluator shall initiate a VPN session between the test client and the TSF and observe that the TSF aborts the session.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event table="sel-based"/>
        </f-component>
      </section>
      <!-- 5.2.9 Identification and Authentication (FIA) -->
      <section title="Identification and Authentication (FIA)" id="fia-selectionBased">
        The TOE may support pre-shared keys for use in the IPsec protocol, and may use pre-shared keys in other protocols as well. 
        PSK in the context of this document refers to generated values, 
        memorized values subject to conditioning, one-time passwords, and combinations as described in FIA_PSK_EXT.1.2.
        <ext-comp-def title="HMAC-Based One-Time Password Pre-Shared Keys" fam-id="FIA_HOTP_EXT">
          <fam-behavior>Components in this family define requirements for the use of HMAC-Based One-Time password authentication, including generation methods and usage restrictions.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Pre-Shared Key Composition" fam-id="FIA_PSK_EXT">
          <fam-behavior>This family defines requirements for what the TSF defines or generates as an acceptably strong pre-shared key for authentication.</fam-behavior>
        </ext-comp-def>
        <ext-comp-def title="Time-Based One-Time Password Pre-Shared Keys" fam-id="FIA_TOTP_EXT">
          <fam-behavior>Components in this family define requirements for the use of Time-Based One-Time password authentication, including generation methods and usage restrictions.</fam-behavior>
        </ext-comp-def>
        <!-- FIA_HOTP_EXT.1 HMAC-Based One-Time Password Pre-Shared Keys -->
        <f-component cc-id="fia_hotp_ext.1" id="fia-hotp-ext-1" name="HMAC-Based One-Time Password Pre-Shared Keys">
          <depends on-sel="pskhotp"/>
          <consistency-rationale>This SFR relates to use of pre-shared keys, which is behavior that only applies to the establishment of IPsec connections.</consistency-rationale>
          <comp-lev> defines the implementation of HOTP.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FCS_COP.1 Cryptographic Operation</dependencies>
          <f-element id="fia-hotp-ext-1e1">
            <title>The TSF shall support HMAC-Based One-Time Password (HOTP) authentication in accordance with RFC 4226 
              to authenticate the user before establishing VPN connection.</title>
          </f-element>
          <f-element id="fia-hotp-ext-1e2">
            <title>
              The TSF shall generate an HOTP seed according to FCS_RBG.1 (from
              <xref to="bibNDcPP"/>) of
              <selectables>
                <selectable id="fia_hotp_ext.1.2_1">128</selectable>
                <selectable id="fia_hotp_ext.1.2_2">256</selectable>
              </selectables>
              bits.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall generate an HOTP seed according to FCS_RBG.1 of
                <selectables>
                  <selectable>128</selectable>
                  <selectable>256</selectable>
                </selectables>
                bits.
              </title>
            </ext-comp-def-title>
          </f-element>
          <f-element id="fia-hotp-ext-1e3">
            <title>The TSF shall generate a new HOTP seed value for each client.</title>
          </f-element>
          <f-element id="fia-hotp-ext-1e4">
            <title>
              The TSF shall use
              <selectables>
                <selectable id="fia_hotp_ext.1.4_1">SHA-1</selectable>
                <selectable id="fia_hotp_ext.1.4_2">SHA-256</selectable>
                <selectable id="fia_hotp_ext.1.4_3">SHA-384</selectable>
                <selectable id="fia_hotp_ext.1.4_4">SHA-512</selectable>
              </selectables>
              with key sizes
              <assignable>key size (in bits) used in HMAC</assignable>
              and message digest sizes
              <selectables>
                <selectable id="fia_hotp_ext.1.4_6">160</selectable>
                <selectable id="fia_hotp_ext.1.4_7">256</selectable>
                <selectable id="fia_hotp_ext.1.4_8">384</selectable>
                <selectable id="fia_hotp_ext.1.4_9">512</selectable>
              </selectables>
              to derive an HOTP hash from the HOTP seed and counter.
            </title>
          </f-element>
          <f-element id="fia-hotp-ext-1e5">
            <title>
              The TSF shall truncate the HOTP hash per FIA_HOTP_EXT.1.4 to create an HOTP of
              <selectables>
                <selectable id="fia_hotp_ext.1.5_1" exclusive="yes">administrator configurable character length of at least 6</selectable>
                <selectable id="fia_hotp_ext.1.5_2">preset character length of <selectables onlyone="yes"><selectable id="fia_hotp_ext.1.5_3">6</selectable><selectable id="fia_hotp_ext.1.5_4">7</selectable><selectable id="fia_hotp_ext.1.5_5">8</selectable><selectable id="fia_hotp_ext.1.5_6">9</selectable><selectable id="fia_hotp_ext.1.5_7">10</selectable></selectables></selectable>
              </selectables>.
            </title>
          </f-element>
          <f-element id="fia-hotp-ext-1e6">
            <title>
              The TSF shall
              <selectables>
                <selectable id="fia_hotp_ext.1.6_1">throttle invalid requests to <selectables><selectable id="fia_hotp_ext.1.6_2">administrator configurable value</selectable><selectable id="fia_hotp_ext.1.6_4"><assignable>value less than 10</assignable></selectable></selectables> per minute</selectable>
                <selectable id="fia_hotp_ext.1.6_5">lock the associated account after <selectables><selectable id="fia_hotp_ext.1.6_6">administrator configurable value</selectable><selectable id="fia_hotp_ext.1.6_8"><assignable>value less than 10</assignable></selectable></selectables> failed attempts until <selectables><selectable id="fia_hotp_ext.1.6_9">an administrator unlocks the account</selectable><selectable id="fia_hotp_ext.1.6_10" exclusive="yes">a configurable time period</selectable></selectables></selectable>
              </selectables>.
            </title>
          </f-element>
          <f-element id="fia-hotp-ext-1e7">
            <title>
              The TSF shall not verify HOTP attempts outside of the counter look ahead window of
              <selectables>
                <selectable id="fia_hotp_ext.1.7_1">a configurable value</selectable>
                <selectable id="fia_hotp_ext.1.7_3">
                  <assignable>a value less than or equal to 3</assignable>
                </selectable>
              </selectables>
              for resynchronization.
            </title>
          </f-element>
          <f-element id="fia-hotp-ext-1e8">
            <title>The TSF shall increment the counter after each successful authentication.</title>
            <note role="application">
              The selection FIA_HOTP_EXT.1.4 must be consistent with the key size specified for the size of the keys used in conjunction with the keyed-hash message authentication.
              <br/>
              In FIA_HOTP_EXT.1.5 the ST author may either provide a configurable character length of at least 6 or a preset size between 6 and 10.
              <br/>
              In FIA_HOTP_EXT.1.6 the ST author may select throttle requests, account lockout, or both.
              <br/>
              The HOTP seed and all derived values are considered secret keys for purposes of protection.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall verify the TSS describes how the HOTP is input into the client and how that value is sent to the server.
                <br/>
                The evaluator shall confirm the TSS describes how the TOE complies with the RFC.
                <br/>
                The evaluator shall confirm the TSS describes how the HOTP seed is generated and ensure it aligns with FCS_RBG.1 (from
                <xref to="bibNDcPP"/>).
                <br/>
                The evaluator shall confirm the TSS describes how the HOTP seed is protected and ensure it aligns with the storage requirements of the Base-PP.
                <br/>
                The evaluator shall confirm the TSS describes how a new HOTP seed is assigned for each client and how each client is uniquely identified.
                <br/>
                The evaluator shall confirm the TSS describes how the HOTP seed is conditioned into an HOTP hash and verify it matches the selection in FIA_HOTP_EXT.1.4.
                <br/>
                The evaluator shall confirm the TSS describes how the HOTP hash is truncated and verify it matches the selection in FIA_HOTP_EXT.1.5.
                <br/>
                The evaluator shall confirm the TSS describes how the TOE handles multiple incoming invalid requests and verify it provides an anti-hammer mechanism that matches the selections made in FIA_HOTP_EXT.1.6.
                <br/>
                The evaluator shall confirm the TSS describes how the TOE handles resynchronization and how it rejects attempts outside of the look-ahead window selected in FIA_TOTP_EXT.1.7.
                <br/>
                The evaluator shall confirm the TSS describes how the TOE counter is incremented after each successful authentication.
                <br/>
              </TSS>
              <Guidance>
                The evaluator shall verify the operational guidance contains any configuration necessary to enable HOTP.
                <br/>
                The evaluator shall verify the operational guidance contains all configuration guidance for setting any administrative value that is configurable in the 
                FIA_HOTP_EXT.1 requirements.
                <br/>
              </Guidance>
              <Tests>
                The evaluator shall configure the TOE to use a supported HOTP factor then:
                <testlist>
                  <test>Attempt to establish a connection using that factor. The evaluator shall verify the client prompts the user for the HOTP before initiating the connection. The evaluator shall verify the server validates the HOTP or receives confirmation from an authentication server before establishing the channel.</test>
                  <test>Attempt to establish a connection using a factor from a different client. The test passes if the client fails to connect.</test>
                  <test>Attempt multiple connections outside the limits set in FIA_HOTP_EXT.1.6 and verify the remediation is triggered. The test passes if remediation is triggered as defined in the selections and assignments.</test>
                  <test>Attempt to use an HOTP that is outside of the value allowed for resynchronization. The test passes if the client fails to connect.</test>
                  <test>Attempt to connect with a valid HOTP, disconnect and attempt to authenticate again with the same HOTP value. The test passes if the client connects the first time and fails to connect the second time. If the HOTP generated is duplicated the test may be repeated.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event table="sel-based"/>
        </f-component>
        <!-- FIA_PSK_EXT.1 Pre-Shared Key Composition -->
        <f-component cc-id="fia_psk_ext.1" id="fia-psk-ext-1" name="Pre-Shared Key Composition">
          <depends on-sel="nd-mod-fcs-ipsec-ext-1"/>
          <depends on-sel="sel-tsf-mfa"/>
          <consistency-rationale>This SFR defines the use of pre-shared keys, which is behavior that only relates to the establishment of IPsec connections.</consistency-rationale>
          <comp-lev>defines the use and composition of pre-shared keys used for IPsec.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FCS_IPSEC_EXT.1 IPsec Protocol</dependencies>
          <f-element id="fia-psk-ext-1e1">
            <title>
              The TSF shall be able to use pre-shared keys for IPsec and
              <selectables>
                <selectable id="fia_psk_ext.1.1_1">IKEv2</selectable>
                <selectable id="fia_psk_ext.1.1_2">multifactor authentication filtering</selectable>
              </selectables>.
            </title>
            <note role="application">If “IKEv2” is selected, then the corresponding IKEv2 selection must be made in FCS_IPSEC_EXT.1.13. 
              If “multifactor authentication filtering” is selected, then “verify” should be selected in FPF_MFA_EXT.1.2.</note>
          </f-element>
          <f-element id="fia-psk-ext-1e2">
            <title>
              The TSF shall be able to accept the following as pre-shared keys:
              <selectables>
                <selectable id="pskgen">generated bit-based</selectable>
                <selectable id="pskpw">password-based</selectable>
                <selectable id="pskhotp">HMAC-based one-time password</selectable>
                <selectable id="psktotp">time-based one-time password</selectable>
                <selectable id="pskgenhotp">combination of a generated bit-based and HMAC-based one-time password</selectable>
                <selectable id="pskgentotp">combination of a generated bit-based and time-based one-time password</selectable>
                <selectable id="pskpwhotp">combination of a password-based and HMAC-based one-time password</selectable>
                <selectable id="pskpwtotp">Combination of a password-based and time-based one-time password</selectable>
              </selectables>
              keys.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall be able to accept the following as pre-shared keys:
                <selectables>
                  <selectable>generated bit-based</selectable>
                  <selectable>password-based</selectable>
                  <selectable>HMAC-based one-time password</selectable>
                  <selectable>time-based one-time password</selectable>
                  <selectable>combination of a generated bit-based and HMAC-based one-time password</selectable>
                  <selectable>combination of a generated bit-based and time-based one-time password</selectable>
                  <selectable>combination of a password-based and HMAC-based one-time password</selectable>
                  <selectable>combination of a password-based and time-based one-time password</selectable>
                </selectables>
                keys.
              </title>
            </ext-comp-def-title>
            <note role="application">
              This requirement is included if “pre-shared keys that conform to RFC 8784” is selected in FCS_IPSEC_EXT.1.13, 
              or if “verify” is selected in FPF_MFA_EXT.1.2. If these selections are made in both FCS_IPSEC_EXT.1.13 and FPF_MFA_EXT.1.2, 
              the TSF must satisfy the appropriate FIA_PSK_EXT.1 selections for each.
              <br/>
              <br/>
              If any selection including "generated bit-based" is chosen, then FIA_PSK_EXT.2 must be included.
              <br/>
              <br/>
              If “pre-shared keys that conform to RFC 8784” is selected in FCS_IPSEC_EXT.1.13, a generated, bit-based PSK must be used.
              <br/>
              <br/>
              If any selection including Password-based keys is chosen, then FIA_PSK_EXT.3 must be included.
              <br/>
              <br/>
              If any selection including HMAC-based one-time password keys is chosen, then FIA_HOTP_EXT.1 must be included.
              <br/>
              <br/>
              If any selection including time-based one-time password is chosen, then FIA_TOTP_EXT.1 must be included.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall confirm that the TSS states which pre-shared key selections are supported for IKEv2 
                per FCS_IPSEC_EXT.1.13 and FPF_MFA_EXT.1.1.
                <br/>
              </TSS>
              <Guidance>
                The evaluator shall examine the operational guidance to determine that it provides guidance to 
                administrators on how to configure all selected pre-shared key options if any configuration is required.
                The evaluator shall examine the operational guidance to determine that it provides guidance to administrators 
                on how to configure the mandatory_or_not flag per RFC 8784.
                <br/>
              </Guidance>
              <Tests>
                The evaluator shall also perform the following tests for each protocol (or instantiation of a protocol, if performed by a different implementation on the TOE).
                <testlist>
                  <test>For each mechanism selected in FIA_PSK_EXT.1.2 the evaluator shall attempt to establish a connection and confirm that the connection requires the selected factors in the PSK to establish the connection in alignment with table 1 from RFC 8784.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event table="sel-based"/>
        </f-component>
        <!-- FIA_PSK_EXT.2 Generated Pre-Shared Keys -->
        <f-component cc-id="fia_psk_ext.2" id="fia-psk-ext-2" name="Generated Pre-Shared Keys">
          <depends on-sel="pskgen"/>
          <depends on-sel="pskgenhotp"/>
          <depends on-sel="pskgentotp"/>
          <consistency-rationale>This SFR relates to use of pre-shared keys, which is behavior that only applies to the establishment of IPsec connections.</consistency-rationale>
          <comp-lev>defines the use and composition of generated pre-shared keys used for IPsec.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>
            The following actions should be auditable if FAU_GEN Security Audit Data Generation is included in the
            PP/ST:
            <ul>
              <li>Failure of the randomization process</li>
            </ul>
          </audit>
          <dependencies>FIA_PSK_EXT.1 Pre-Shared Key Composition</dependencies>
          <f-element id="fia-psk-ext-2e1">
            <title>
              The TSF shall be able to
              <selectables>
                <selectable id="fia_psk_ext.2.1_1">accept externally generated pre-shared keys</selectable>
                <selectable id="fia_psk_ext.2.1_2">generate <selectables><selectable id="fia_psk_ext.2.1_3">128</selectable><selectable id="fia_psk_ext.2.1_4">256</selectable></selectables> bit-based pre-shared keys via FCS_RBG.1 <b>(from <xref to="bibNDcPP"/>)</b>.</selectable>
              </selectables>
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall be able to
                <selectables>
                  <selectable>accept externally generated pre-shared keys</selectable>
                  <selectable>
                    generate
                    <selectables>
                      <selectable>128</selectable>
                      <selectable>256</selectable>
                    </selectables>
                    bit-based pre-shared keys via FCS_RBG.1.
                  </selectable>
                </selectables>
              </title>
            </ext-comp-def-title>
            <note role="application">
              Generated PSKs are expected to be shared between components via an out of band mechanism.
              <br/>
              This requirement is selection dependent on FIA_PSK_EXT.1.
              <br/>
            </note>
            <aactivity>
              <TSS>
                If "generate" is selected, the evaluator shall confirm that this process uses the RBG specified in FCS_RBG.1 (from
                <xref to="bibNDcPP"/>)
                and the output matches the size selected in FIA_PSK_EXT.2.1.
                <br/>
              </TSS>
              <Guidance>
                The evaluator shall confirm the operational guidance contains instructions for entering generated pre-shared keys 
                for each protocol identified in the FIA_PSK_EXT.1.1.
                <br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>[conditional] If generate was selected the evaluator shall generate a pre-shared key and confirm the output matches the size selected in FIA_PSK_EXT.2.1.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event table="sel-based"/>
        </f-component>
        <!-- FIA_PSK_EXT.3 Password-Based Pre-Shared Keys -->
        <f-component cc-id="fia_psk_ext.3" id="fia-psk-ext-3" name="Password-Based Pre-Shared Keys">
          <depends on-sel="pskpw"/>
          <depends on-sel="pskpwhotp"/>
          <depends on-sel="pskpwtotp"/>
          <consistency-rationale>This SFR relates to use of pre-shared keys, which is behavior that only applies to the establishment of IPsec connections.</consistency-rationale>
          <comp-lev>defines the use and composition of password-based pre-shared keys used for IPsec.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>
            The following actions should be auditable if FAU_GEN Security Audit Data Generation is included in the
            PP/ST:
            <ul>
              <li>Failure of the randomization process</li>
            </ul>
          </audit>
          <dependencies>FIA_PSK_EXT.1 Pre-Shared Key Composition</dependencies>
          <f-element id="fia-psk-ext-3e1">
            <title>
              The TSF shall support a PSK of up to
              <assignable>positive integer of 64 or more</assignable>
              characters.
            </title>
          </f-element>
          <f-element id="fia-psk-ext-3e2">
            <title>
              The TSF shall allow PSKs to be composed of any combination of upper case characters, 
              lower case characters, numbers, and the following special characters: "!", "@", "#", "$", "%", "^", "&amp;", "*", "(", and ")", and
              <selectables>
                <selectable id="fia_psk_ext.3.2_2">
                  <assignable>other supported special characters</assignable>
                </selectable>
                <selectable id="fia_psk_ext.3.2_3" exclusive="yes">no other characters</selectable>
              </selectables>
            </title>
          </f-element>
          <f-element id="fia-psk-ext-3e3">
            <title>
              The TSF shall perform Password-based Key Derivation Functions in accordance with a specified cryptographic algorithm HMAC-[<i>SHA-384, with <assignable>positive integer of 4096 or more</assignable></i>] iterations, and output cryptographic key sizes [<i>256</i>] that meet the following: [<i>NIST SP 800-132</i>].
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall perform Password-based Key Derivation Functions in accordance with a specified cryptographic algorithm
                <assignable>cryptographic algorithm</assignable>
                and output cryptographic key sizes
                <assignable>output key sizes</assignable>
                that meet the following:
                <assignable>applicable standard</assignable>.
              </title>
            </ext-comp-def-title>
          </f-element>
          <f-element id="fia-psk-ext-3e4">
            <title>
              The TSF shall not accept PSKs less than
              <selectables>
                <selectable id="fia_psk_ext.3.4_1">a value settable by the administrator</selectable>
                <selectable id="fia_psk_ext.3.4_3">
                  <assignable>minimum PSK length accepted by the TOE, must be >= 6</assignable>
                </selectable>
              </selectables>
              and greater than the maximum PSK length defined in FIA_PSK_EXT.3.1.
            </title>
          </f-element>
          <f-element id="fia-psk-ext-3e5">
            <title>
              The TSF shall generate all salts using an RBG that meets FCS_RBG.1
              <b>(from <xref to="bibNDcPP"/>)</b>
              and with entropy of
              <assignable>value equal to or greater than 128</assignable>
              bits.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall generate all salts using an RBG that meets FCS_RBG.1 and with entropy of
                <assignable>value equal to or greater than 128</assignable>
                bits.
              </title>
            </ext-comp-def-title>
          </f-element>
          <f-element id="fia-psk-ext-3e6">
            <title>The TSF shall require the PSK to be entered before every initiated connection.</title>
          </f-element>
          <f-element id="fia-psk-ext-3e7">
            <title>
              The TSF shall
              <selectables>
                <selectable id="fia_psk_ext.3.7_1">provide a password strength meter</selectable>
                <selectable id="fia_psk_ext.3.7_2">check the password against a denylist</selectable>
                <selectable id="fia_psk_ext.3.7_3" exclusive="yes">perform no action to assist the user in choosing a strong password</selectable>
              </selectables>.
            </title>
            <note role="application">
              For FIA_PSK_EXT.3.1, the ST author assigns the maximum size of the PSK it supports; it must support at least 64 characters or a length defined by the platform.
              <br/>
              For FIA_PSK_EXT.3.2, the ST author assigns any other supported characters; if there are no other supported characters, they should select "no other characters."<br/>
              For FIA_PSK_EXT.3.3, the ST author selects the parameters based on the PBKDF used by the TSF.
              <br/>
              For FIA_PSK_EXT.3.4 If the minimum length is settable, then the ST author chooses "a value settable by the administrator." If the minimum length is not settable, 
              the ST author fills in the assignment with the minimum length the PSK must be. This requirement is to ensure bounds work properly.
              <br/>
              For FIA_PSK_EXT.3.7, the ST author may select one, both, or neither of the functions in alignment with NIST SP 800-63b.
              <br/>
              This requirement is selection dependent on FIA_PSK_EXT.1.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to ensure it describes the process by which the password-based pre-shared keys are used.
                <br/>
                Support for length: The evaluator shall check to ensure that the TSS describes the allowable ranges for PSK lengths, and that at least 64 characters or a length defined by the platform may be specified by the user.
                <br/>
                Support for character set: The evaluator shall check to ensure that the TSS describes the allowable character set and that it contains the characters listed in the SFR.
                <br/>
                Support for PBKDF: The evaluator shall examine the TSS to ensure that the use of PBKDF2 is described and that the key sizes match that described by the ST author.
                <br/>
                The evaluator shall check that the TSS describes the method by which the PSK is first encoded and then fed to the hash algorithm. The settings for the algorithm (padding, blocking, etc.) shall be described, and the evaluator shall verify that these are supported by the selections in this component as well as the selections concerning the hash function itself.
                <br/>
                For the NIST SP 800-132-based conditioning of the PSK, the required evaluation activities will be performed when doing the evaluation activities for the appropriate requirements (FCS_COP.1/KeyedHash).
                <br/>
                The evaluator shall confirm that the minimum length is described.
                <br/>
                The ST author shall provide a description in the TSS regarding the salt generation. The evaluator shall confirm that the salt is generated using an RBG described in FCS_RBG.1 (from
                <xref to="bibNDcPP"/>).
                <br/>
                [conditional] If password strength meter or password denylist is selected, the evaluator shall examine the TSS to ensure any password checking functionality provided by the TSF is described and contains details on how the function operates.
                <br/>
              </TSS>
              <Guidance>
                The evaluator shall confirm the operational guidance contains instructions for entering password-based pre-shared keys for each 
                protocol identified in the requirement. The evaluator shall confirm that any 
                management functions related to pre-shared keys that are performed by the TOE are specified in the operational guidance.
                <br/>
                The guidance must specify the allowable characters for pre-shared keys, and that list must include, at minimum, the same 
                items contained in FIA_PSK_EXT.3.2.
                <br/>
                The evaluator shall confirm the operational guidance contains any necessary instructions for enabling and configuring password checking functionality.
                <br/>
              </Guidance>
              <Tests>
                Support for Password/Passphrase characteristics: In addition to the analysis above, the evaluator shall also perform the following tests on a TOE configured according to the Operational Guidance:
                <testlist>
                  <test>The evaluator shall compose a pre-shared key of at least 64 characters that contains a combination of the allowed characters in accordance with the FIA_PSK_EXT.3.2 and verify that a successful protocol negotiation can be performed with the key.</test>
                  <test>[conditional]: If the TOE supports pre-shared keys of multiple lengths, the evaluator shall repeat Test 1 using the minimum length and invalid lengths that are below the minimum length, above the maximum length, null length, empty length, or zero length. The minimum test should be successful, and the invalid lengths must be rejected by the TOE.</test>
                  <test>[conditional]: If the TOE initiates connections, initiate and establish a remote connection, disconnect from the connection, verify that the PSK is required when initiating the connection a second time.</test>
                  <test>[conditional]: If the TOE supports a password meter, the evaluator shall enter a password and verify the password checker responds per the description in the TSS.</test>
                  <test>[conditional]: If the TOE supports a password denylist, the evaluator shall enter a denylisted password and verify that the password is rejected or flagged as such.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event table="sel-based"/>
        </f-component>
        <!-- FIA_TOTP_EXT.1 Time-Based One-Time Password Pre-Shared Keys -->
        <f-component cc-id="fia_totp_ext.1" id="fia-totp-ext-1" name="Time-Based One-Time Password Pre-Shared Keys">
          <depends on-sel="psktotp"/>
          <consistency-rationale>This SFR relates to use of pre-shared keys, which is behavior that only applies to the establishment of IPsec connections.</consistency-rationale>
          <comp-lev>defines the implementation of TOTP.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>FPT_STM.1 Reliable Time Stamps</dependencies>
          <f-element id="fia-totp-ext-1e1">
            <title>The TSF shall support Time-Based One-Time Password (TOTP) authentication in accordance with RFC 6238 
              to authenticate the user before establishing VPN connection.</title>
          </f-element>
          <f-element id="fia-totp-ext-1e2">
            <title>
              The TSF shall generate a TOTP seed according to FCS_RBG.1 (from
              <xref to="bibNDcPP"/>)of
              <selectables>
                <selectable id="fia_totp_ext.1.2_1">128</selectable>
                <selectable id="fia_totp_ext.1.2_2">256</selectable>
              </selectables>
              bits.
            </title>
            <ext-comp-def-title>
              <title>
                The TSF shall generate a TOTP seed according to FCS_RBG.1 of
                <selectables>
                  <selectable>128</selectable>
                  <selectable>256</selectable>
                </selectables>
                bits.
              </title>
            </ext-comp-def-title>
          </f-element>
          <f-element id="fia-totp-ext-1e3">
            <title>The TSF shall generate a new TOTP seed for each client.</title>
          </f-element>
          <f-element id="fia-totp-ext-1e4">
            <title>
              The TSF shall use
              <selectables>
                <selectable id="fia_totp_ext.1.4_1">SHA-1</selectable>
                <selectable id="fia_totp_ext.1.4_2">SHA-256</selectable>
                <selectable id="fia_totp_ext.1.4_3">SHA-384</selectable>
                <selectable id="fia_totp_ext.1.4_4">SHA-512</selectable>
              </selectables>
              with key sizes
              <assignable>key size (in bits) used in HMAC</assignable>
              and message digest sizes
              <selectables>
                <selectable id="fia_totp_ext.1.4_6">160</selectable>
                <selectable id="fia_totp_ext.1.4_7">256</selectable>
                <selectable id="fia_totp_ext.1.4_8">384</selectable>
                <selectable id="fia_totp_ext.1.4_9">512</selectable>
              </selectables>
              to derive a TOTP hash from the TOTP seed and current time provided by NTP.
            </title>
          </f-element>
          <f-element id="fia-totp-ext-1e5">
            <title>
              The TSF shall truncate the TOTP hash per FIA_TOTP_EXT.1.4 to create a TOTP of
              <selectables>
                <selectable id="fia_totp_ext.1.5_1" exclusive="yes">administrator configurable character length of at least 6</selectable>
                <selectable id="fia_totp_ext.1.5_2">preset character length of <selectables onlyone="yes"><selectable id="fia_totp_ext.1.5_3">6</selectable><selectable id="fia_totp_ext.1.5_4">7</selectable><selectable id="fia_totp_ext.1.5_5">8</selectable><selectable id="fia_totp_ext.1.5_6">9</selectable><selectable id="fia_totp_ext.1.5_7">10</selectable></selectables></selectable>
              </selectables>.
            </title>
          </f-element>
          <f-element id="fia-totp-ext-1e6">
            <title>
              The TSF shall
              <selectables>
                <selectable id="fia_totp_ext.1.6_1">throttle invalid requests to <selectables><selectable id="fia_totp_ext.1.6_2">administrator configurable value</selectable><selectable id="fia_totp_ext.1.6_4"><assignable>value less than 10</assignable></selectable></selectables> per minute</selectable>
                <selectable id="fia_totp_ext.1.6_5">lock the associated account after <selectables><selectable id="fia_totp_ext.1.6_6">administrator configurable value</selectable><selectable id="fia_totp_ext.1.6_8"><assignable>value less than 10</assignable></selectable></selectables> failed attempts until <selectables><selectable id="fia_totp_ext.1.6_9">an administrator unlocks the account</selectable><selectable id="fia_totp_ext.1.6_10" exclusive="yes">a configurable time period</selectable></selectables></selectable>
              </selectables>.
            </title>
          </f-element>
          <f-element id="fia-totp-ext-1e7">
            <title>
              The TSF shall set a time-step size of
              <selectables>
                <selectable id="fia_totp_ext.1.7_1">a configurable value</selectable>
                <selectable id="fia_totp_ext.1.7_3">
                  <assignable>a value less than or equal to 30</assignable>
                </selectable>
              </selectables>
              seconds.
            </title>
          </f-element>
          <f-element id="fia-totp-ext-1e8">
            <title>
              The TSF shall not validate a drift of more than
              <selectables>
                <selectable id="fia_totp_ext.1.8_1">a configurable value</selectable>
                <selectable id="fia_totp_ext.1.8_3">
                  <assignable>a value less than or equal to 3</assignable>
                </selectable>
              </selectables>
              time-steps.
            </title>
          </f-element>
          <f-element id="fia-totp-ext-1e9">
            <title>
              The TSF shall
              <selectables>
                <selectable id="fia_totp_ext.1.9_1">allow resynchronization by recording time drift within the limit of FIA_TOTP_EXT.1.8</selectable>
                <selectable id="fia_totp_ext.1.9_2" exclusive="yes">not permit resynchronization</selectable>
              </selectables>.
            </title>
            <note role="application">
              The selection FIA_TOTP_EXT.1.4 must be consistent with the key size specified for the size of the keys used in conjunction with the keyed-hash message authentication.
              <br/>
              In FIA_TOTP_EXT.1.5 the ST author may either provide a configurable character length of at least 6 or a preset size between 6 and 10.
              <br/>
              In FIA_TOTP_EXT.1.6 the ST author may select throttle requests, account lockout, or both.
              <br/>
              The TOTP seed and all derived values are considered secret keys for purposes of protection.
            </note>
            <aactivity>
              <TSS>
                The evaluator shall verify the TSS describes how the TOTP is input into the client and how that value is sent to the server.
                <br/>
                The evaluator shall confirm the TSS describes how the TOE complies with the RFC.
                <br/>
                The evaluator shall confirm the TSS describes how the TOTP seed is generated and ensure it aligns with FCS_RBG.1 (from
                <xref to="bibNDcPP"/>).
                <br/>
                The evaluator shall confirm the TSS describes how the TOTP seed is protected and ensure it aligns with the storage requirements of the Base-PP.
                <br/>
                The evaluator shall confirm the TSS describes how a new TOTP seed is assigned for each client and how each client is uniquely identified.
                <br/>
                The evaluator shall confirm the TSS describes how the TOTP seed is conditioned into a TOTP hash and verify it matches the selection in FIA_TOTP_EXT.1.4.
                <br/>
                The evaluator shall confirm the TSS describes how the TOTP hash is truncated and verify it matches the selection in FIA_TOTP_EXT.1.5.
                <br/>
                The evaluator shall confirm the TSS describes how the TOE handles multiple incoming requests and verify it provides an anti-hammer mechanism that matches the selections made in FIA_TOTP_EXT.1.6.
                <br/>
                The evaluator shall confirm the TSS describes how the TOE sets a time-step value and verify it matches the selections in the ST.
                <br/>
                The evaluator shall confirm the TSS describes how the TOE handles drift and resynchronization and verify it matches the selections.  The evaluator shall ensure the TSS describes how time is kept and whether drift is calculated and recorded.  
                If drift is recorded, the evaluator shall ensure that the TSS describes how this is done.
                <br/>
              </TSS>
              <Guidance>
                The evaluator shall verify the operational guidance contains any configuration necessary to enable TOTP.
                <br/>
                The evaluator shall verify the operational guidance contains all configuration guidance for setting any administrative value that is configurable in the FIA_TOTP_EXT.1 requirements.
                <br/>
              </Guidance>
              <Tests>
                The evaluator shall configure the TOE to use a supported TOTP factor then:
                <testlist>
                  <test>Attempt to establish a connection using that factor. The evaluator shall verify the client prompts the user for the TOTP before initiating the connection. The evaluator shall verify the server validates the TOTP or receives confirmation from an authentication server before establishing the channel.</test>
                  <test>Attempt to establish a connection using a factor from a different client. The test passes if the client fails to connect.</test>
                  <test>Attempt multiple connections outside the limits set in FIA_TOTP_EXT.1.6 and verify the remediation is triggered. The test passes if remediation is triggered as defined in the selections and assignments.</test>
                  <test>Attempt to use a TOTP that is outside of the value allowed for resynchronization. The test passes if the client fails to connect.</test>
                  Attempt to connect with a valid TOTP, disconnect and attempt to authenticate again with the same TOTP. The test passes if the client connects the first time and fails to connect the second time. If the TOTP generated is duplicated the test may be repeated.
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event table="sel-based"/>
        </f-component>
      </section>
    </sel-sfrs>
    <obj-sfrs/>
    <impl-dep-sfrs>
      <section id="sib-audit-table" title="Auditable Events for Implementation-Based SFRs">
        <audit-table id="impl-audit-events" table="feat-based"/>
      </section>
      <!-- 5.2.10 TOE Access (FTA) -->
      <section title="TOE Access (FTA)" id="fta-implementationDependent">
        This section contains requirements that may be optionally selected by the ST author for a “headend” VPN
	    gateway device. The requirements in the main body of this PP-Module are those determined necessary
	    for a multi-site VPN gateway appliance. Another application of a VPN appliance is in an architecture that
	    is intended to serve mobile users, by providing a secure means in which a remote client may access a
	    trusted network. These devices provide the capability to manage remote VPN clients (e.g., assigning IP
	    addresses, managing client sessions) that are not necessarily found in VPN gateways that are limited to
	    providing a secure communication path between trusted networks. Rather than mandate that all VPN
	    gateways provide this mobility aspect, the requirements below are specified as an option. What this
	    means is that multi-site VPN gateways do not have to provide these capabilities, but those devices wishing
	    to serve the mobility community should implement the optional requirements from this Appendix in
	    addition to all mandatory and selection-based requirements that apply to them.
        <ext-comp-def title="VPN Client Management" fam-id="FTA_VCM_EXT">
          <fam-behavior>This family defines requirements for how the TSF interacts with VPN clients in its OE.</fam-behavior>
        </ext-comp-def>
        <!-- FTA_SSL.3/VPN TSF-Initiated Termination (VPN Headend) -->
        <f-component cc-id="fta_ssl.3" id="fta-ssl-3-vpn" name="TSF-Initiated Termination (VPN Headend)" iteration="VPN">
          <consistency-rationale>This SFR refers to a specific condition under which a trusted channel is
	        terminated by the TSF. The Base-PP supports termination of trusted
	        channels and does not mandate this be done in any particular method.</consistency-rationale>
          <f-element id="fta-ssl-3e1-vpn">
            <title>
              The TSF shall terminate
              <b>a remote VPN client</b>
              session after [<i>an Administrator-configurable time interval of session inactivity</i>].
            </title>
            <note role="application">This requirement exists in the NDcPP; however, it is intended to address an interactive administrative session. 
            Here, the requirement applies to a VPN client that has established an SA. After some configurable time period without any
	          activity, the connection between the VPN headend and client is terminated.</note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to verify that it describes the ability of the TSF to terminate an inactive
	            VPN client session.
                <br/>
              </TSS>
              <Guidance>
                The evaluator shall examine the operational guidance to verify that it provides instructions to the
	            administrator on how to configure the time limit for termination of an active VPN client session.
                <br/>
              </Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                  <test>The evaluator shall follow the steps provided in the operational guidance to set the inactivity timer for five minutes. The evaluator shall then connect a VPN client to the TOE, let it sit idle for four minutes and fifty seconds, and observe that the VPN client is still connected at this time by performing an action that would require VPN access. The evaluator shall then disconnect the client, reconnect it, wait five minutes and ten seconds, attempt the same action, and observe that it does not succeed. The evaluator shall then verify using audit log data that the VPN client session lasted for exactly five minutes.</test>
                  <test>The evaluator shall configure the inactivity timer to ten minutes and repeat Test 1, adjusting the waiting periods and expected audit log data accordingly.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event table="feat-based"/>
        </f-component>
        <!-- FTA_TSE.1 TOE Session Establishment -->
        <f-component cc-id="fta_tse.1" id="fta-tse-1" name="TOE Session Establishment">
          <consistency-rationale>This SFR refers to a specific condition under which a trusted channel is
	        terminated by the TSF. The Base-PP supports termination of trusted
	        channels and does not mandate this be done in any particular method.</consistency-rationale>
          <f-element id="fta-tse-1e1">
            <title>
              The TSF shall be able to deny session establishment
              <b>of a remote VPN client session</b>
              based
	          on [<i>location, time, day,  <selectables><selectable id="fta_tse.1.1_1" exclusive="yes">no other attributes</selectable><selectable id="fta_tse.1.1_3"><assignable>other attributes</assignable></selectable></selectables></i>].
            </title>
            <note role="application">For this PP-Module, “location” is defined as the client’s IP address.</note>
            <aactivity>
              <TSS>
                The evaluator shall examine the TSS to verify that it describes the methods by which the TSF can deny the
	            establishment of an otherwise valid remote VPN client session (e.g., client credential is valid, not expired,
	            not revoked, etc.), including day, time, and IP address at a minimum.
                <br/>
              </TSS>
              <Guidance>
                The evaluator shall review the operational guidance to determine that it provides instructions for how to
	            enable an access restriction that will deny VPN client session establishment for each attribute described
	            in the TSS.
                <br/>
              </Guidance>
              <Tests>
                The evaluator shall perform the following tests:
                <testlist>
                  <test>The evaluator shall successfully connect a remote VPN client to the TOE and then disconnect it, noting the IP address from which the client connected. The evaluator shall follow the steps described in the operational guidance to prohibit that IP address from connecting, attempt to reconnect using the same VPN client, and observe that it is not successful.</test>
                  <test>The evaluator shall successfully connect a remote VPN client to the TOE and then disconnect it. The evaluator shall follow the steps described in the operational guidance to prohibit the VPN client from connecting on a certain day (whether this is a day of the week or specific calendar date), attempt to reconnect using the same VPN client, and observe that it is not successful.</test>
                  <test>The evaluator shall successfully connect a remote VPN client to the TOE and then disconnect it. The evaluator shall follow the steps described in the operational guidance to prohibit the VPN client during a range of times that includes the time period during which the test occurs, attempt to reconnect using the same VPN client, and observe that it is not successful.</test>
                  <test>(conditional, the "other attributes" assignment has been selected and completed with one or more additional attributes) For any other attributes that are identified in FTA_TSE.1, the evaluator shall conduct a test similar to the previous three tests to demonstrate the enforcement of each of these attributes. The evaluator shall demonstrate a successful remote client VPN connection, configure the TSF to deny that connection based on the attribute, and demonstrate that a subsequent connection attempt is unsuccessful.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
          <audit-event table="feat-based"/>
        </f-component>
        <!-- FTA_VCM_EXT.1 VPN Client Management -->
        <f-component cc-id="fta_vcm_ext.1" id="fta-vcm-ext-1" name="VPN Client Management">
          <consistency-rationale>This SFR refers to network addressing, which is outside the scope of the
	        Base-PP and therefore not prohibited by it.</consistency-rationale>
          <comp-lev>requires the TSF to assign private (internal) IP addresses
	        to VPN clients that successfully establish IPsec connections with it.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>
            FCS_IPSEC_EXT.1 IPsec Protocol
            <br/>
            [FTP_ITC.1 Inter-TSF Trusted Channel, or
            <br/>
            FTP_TRP.1 Trusted Path]
          </dependencies>
          <f-element id="fta-vcm-ext-1e1">
            <title>The TSF shall assign a private IP address to a VPN client upon successful establishment of a security session.</title>
            <note role="application">For this requirement, the private IP address is one that is internal to the trusted
	          network for which the TOE is the headend.</note>
            <aactivity>
              <TSS>
                The evaluator shall check the TSS to verify that it asserts the ability of the TSF to assign a private IP address
	            to a connected VPN client.
                <br/>
              </TSS>
              <Guidance>There are no guidance EAs for this component.<br/></Guidance>
              <Tests>The evaluator shall connect a remote VPN client to the TOE and record its IP address as well as the internal IP address of the TOE. The evaluator shall verify that the two IP addresses belong to the same network. The evaluator shall disconnect the remote VPN client and verify that the IP address of its underlying platform is no longer part of the private network identified in the previous step.</Tests>
            </aactivity>
          </f-element>
          <audit-event table="feat-based"/>
        </f-component>
      </section>
    </impl-dep-sfrs>
  </sec:Security_Requirements>
  <appendix title="Implicitly Satisfied Requirements" id="satisfiedreqs">
    <!--   Boilerplate goes here   -->
    <!--  	This appendix lists requirements that should be considered satisfied by products successfully evaluated
	against this PP. However, these requirements are not featured explicitly as SFRs and should not be
	included in the ST. They are not included as standalone SFRs because it would increase the time, cost,
	and complexity of evaluation. This approach is permitted by [CC] Part 1, 8.2 Dependencies between
	components.<h:br/>
	This information benefits systems engineering activities which call for inclusion of particular security
	controls. Evaluation against the PP-Module provides evidence that these controls are present and have
	been evaluated.
  -->
    <!--   
	<h:b><ctr ctr-type="Table" pre="Table " id="imp-sat-reqs-table">: Implicitly Satisfied Requirements</ctr></h:b>   -->
    All SFR dependencies in this PP-Module are addressed by appropriate SFRs, either from elsewhere in the PP-Module or inherited from the Base-PP.
    <!--   
  <h:table>	
		<h:tr class="header"><h:td>Requirement</h:td><h:td>Rationale for Satisfaction</h:td></h:tr>
	<h:tr>
	<h:td><h:b>Placeholder</h:b></h:td>
	<h:td>
	  	Placeholder
	</h:td>
	</h:tr>
    </h:table>    -->
  </appendix>
  <appendix title="Entropy Documentation and Assessment" id="app-ent">The TOE does not require any additional supplementary information to describe its entropy sources
	beyond the requirements outlined in the Base-PP. As with other Base-PP requirements, the only
	additional requirement is that the entropy documentation also applies to the specific VPN gateway
	capabilities of the TOE in addition to the functionality required by the claimed Base-PP.</appendix>
  <bibliography>
    <entry id="bibNDcPP">
      <tag>NDcPP</tag>
      <description>
        <a href="https://www.niap-ccevs.org/protectionprofiles/524">collaborative Protection Profile for Network Devices, Version 4.0, December 22, 2025</a>
      </description>
    </entry>
  </bibliography>
</Module>
